{"version":3,"file":"AccessControl.VNJKewrd.js","sources":["../../../../../../src/lib/components/workspace/common/AccessControl.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { getContext, onMount } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\n\timport { getGroups } from '$lib/apis/groups';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport Plus from '$lib/components/icons/Plus.svelte';\n\timport UserCircleSolid from '$lib/components/icons/UserCircleSolid.svelte';\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\n\texport let onChange: Function = () => {};\n\n\texport let accessControl = null;\n\n\tlet selectedGroupId = '';\n\tlet groups = [];\n\n\tonMount(async () => {\n\t\tgroups = await getGroups(localStorage.token);\n\n\t\tif (accessControl === null) {\n\t\t\taccessControl = null;\n\t\t} else {\n\t\t\taccessControl = {\n\t\t\t\tread: {\n\t\t\t\t\tgroup_ids: accessControl?.read?.group_ids ?? [],\n\t\t\t\t\tuser_ids: accessControl?.read?.user_ids ?? []\n\t\t\t\t},\n\t\t\t\twrite: {\n\t\t\t\t\tgroup_ids: accessControl?.write?.group_ids ?? [],\n\t\t\t\t\tuser_ids: accessControl?.write?.user_ids ?? []\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t});\n\n\t$: onChange(accessControl);\n</script>\n\n<div class=\" rounded-lg flex flex-col gap-2\">\n\t<div class=\"\">\n\t\t<div class=\" text-sm font-semibold mb-1\">{$i18n.t('Visibility')}</div>\n\n\t\t<div class=\"flex gap-2.5 items-center mb-1\">\n\t\t\t<div>\n\t\t\t\t<div class=\" p-2 bg-black/5 dark:bg-white/5 rounded-full\">\n\t\t\t\t\t{#if accessControl !== null}\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tstroke-width=\"1.5\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"w-5 h-5\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\td=\"M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tstroke-width=\"1.5\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"w-5 h-5\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\td=\"M6.115 5.19l.319 1.913A6 6 0 008.11 10.36L9.75 12l-.387.775c-.217.433-.132.956.21 1.298l1.348 1.348c.21.21.329.497.329.795v1.089c0 .426.24.815.622 1.006l.153.076c.433.217.956.132 1.298-.21l.723-.723a8.7 8.7 0 002.288-4.042 1.087 1.087 0 00-.358-1.099l-1.33-1.108c-.251-.21-.582-.299-.905-.245l-1.17.195a1.125 1.125 0 01-.98-.314l-.295-.295a1.125 1.125 0 010-1.591l.13-.132a1.125 1.125 0 011.3-.21l.603.302a.809.809 0 001.086-1.086L14.25 7.5l1.256-.837a4.5 4.5 0 001.528-1.732l.146-.292M6.115 5.19A9 9 0 1017.18 4.64M6.115 5.19A8.965 8.965 0 0112 3c1.929 0 3.716.607 5.18 1.64\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<select\n\t\t\t\t\tid=\"models\"\n\t\t\t\t\tclass=\"outline-none bg-transparent text-sm font-medium rounded-lg block w-fit pr-10 max-w-full placeholder-gray-400\"\n\t\t\t\t\tvalue={accessControl !== null ? 'private' : 'public'}\n\t\t\t\t\ton:change={(e) => {\n\t\t\t\t\t\tif (e.target.value === 'public') {\n\t\t\t\t\t\t\taccessControl = null;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\taccessControl = {\n\t\t\t\t\t\t\t\tread: {\n\t\t\t\t\t\t\t\t\tgroup_ids: []\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<option class=\" text-gray-700\" value=\"private\" selected>Private</option>\n\t\t\t\t\t<option class=\" text-gray-700\" value=\"public\" selected>Public</option>\n\t\t\t\t</select>\n\n\t\t\t\t<div class=\" text-xs text-gray-400 font-medium\">\n\t\t\t\t\t{#if accessControl !== null}\n\t\t\t\t\t\t{$i18n.t('Only select users and groups with permission can access')}\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t{$i18n.t('Accessible to all users')}\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t{#if accessControl !== null}\n\t\t{@const accessGroups = groups.filter((group) =>\n\t\t\taccessControl.read.group_ids.includes(group.id)\n\t\t)}\n\t\t<div>\n\t\t\t<div class=\"\">\n\t\t\t\t<div class=\"flex justify-between mb-1.5\">\n\t\t\t\t\t<div class=\"text-sm font-semibold\">\n\t\t\t\t\t\t{$i18n.t('Groups')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"flex flex-col gap-2\">\n\t\t\t\t\t{#if accessGroups.length > 0}\n\t\t\t\t\t\t{#each accessGroups as group}\n\t\t\t\t\t\t\t<div class=\"flex items-center gap-3 justify-between text-xs w-full transition\">\n\t\t\t\t\t\t\t\t<div class=\"flex items-center gap-1.5 w-full font-medium\">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<UserCircleSolid className=\"size-4\" />\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t{group.name}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\"w-full flex justify-end\">\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclass=\" rounded-full p-1 hover:bg-gray-100 dark:hover:bg-gray-850 transition\"\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\taccessControl.read.group_ids = accessControl.read.group_ids.filter(\n\t\t\t\t\t\t\t\t\t\t\t\t(id) => id !== group.id\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<XMark />\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<div class=\"flex items-center justify-center\">\n\t\t\t\t\t\t\t<div class=\"text-gray-500 text-xs text-center py-2 px-10\">\n\t\t\t\t\t\t\t\t{$i18n.t('No groups with access, add a group to grant access')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<hr class=\" my-2 border-black/5 dark:border-white/5\" />\n\n\t\t\t<div class=\"mb-1\">\n\t\t\t\t<div class=\"flex w-full\">\n\t\t\t\t\t<div class=\"flex flex-1 items-center\">\n\t\t\t\t\t\t<div class=\"w-full\">\n\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\tclass=\"outline-none bg-transparent text-sm font-medium rounded-lg block w-full pr-10 max-w-full dark:placeholder-gray-700\"\n\t\t\t\t\t\t\t\tbind:value={selectedGroupId}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<option class=\" text-gray-700\" value=\"\" disabled selected\n\t\t\t\t\t\t\t\t\t>{$i18n.t('Select a group')}</option\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{#each groups.filter((group) => !accessControl.read.group_ids.includes(group.id)) as group}\n\t\t\t\t\t\t\t\t\t<option class=\" text-gray-700\" value={group.id}>{group.name}</option>\n\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Add Group')}>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass=\" p-1 rounded-xl bg-transparent dark:hover:bg-white/5 hover:bg-black/5 transition font-medium text-sm flex items-center space-x-1\"\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tif (selectedGroupId !== '') {\n\t\t\t\t\t\t\t\t\t\t\taccessControl.read.group_ids = [\n\t\t\t\t\t\t\t\t\t\t\t\t...accessControl.read.group_ids,\n\t\t\t\t\t\t\t\t\t\t\t\tselectedGroupId\n\t\t\t\t\t\t\t\t\t\t\t];\n\n\t\t\t\t\t\t\t\t\t\t\tselectedGroupId = '';\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Plus className=\"size-3.5\" />\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t{/if}\n</div>\n"],"names":["constants_0","child_ctx","group","insert_hydration","target","svg","anchor","append_hydration","path","ctx","set_data","t_value","each_value","ensure_array_like","i","add_render_callback","select","div9","div3","div1","div0","div2","hr","div8","div7","div6","div4","option","div5","t0","t0_value","t4","t4_value","t","each_blocks","t1_value","button","current","dirty","t1","option_value_value","create_if_block_3","create_if_block_2","if_block2","create_if_block","get_if_ctx","option0","option1","select_option","select_value_value","i18n","getContext","onChange","accessControl","$$props","selectedGroupId","groups","onMount","getGroups","$$invalidate","_a","_b","_c","_d","e","id","select_value"],"mappings":"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"}