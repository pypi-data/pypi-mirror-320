
##### JAVA
export REPO="yourproject_root/"

export JAVA_HOME='/usr/bin/jre'
#### Common path for all services
export HADOOP_ROOT="/usr/local/hdp/"



#### Hadoop  ###################################################
export HDP_VERSION=3.1.4.0-315
export HADOOP_HOME='$HADOOP_ROOT/hadoop'
export HADOOP_CONF_DIR='$HADOOP_HOME/etc/hadoop'
export HADOOP_LZO_DIR="$HADOOP_HOME/lib"
export HADOOP_CLASSPATH="$HADOOP_CLASSPATH:$HADOOP_ROOT/*:$HADOOP_ROOT/jars/*:/usr/hdp314/hadoop/lib/*:$HADOOP_HOME/lib/native/*:$HADOOP_HOME/lib/native/Linux-amd64-64/*"
export LD_LIBRARY_PATH=:$HADOOP_HOME/lib/native:$HADOOP_HOME/lib/native/Linux-amd64-64:$HADOOP_ROOT/


#### Hive / HBase  ##############################################
export HIVE_HOME='$HADOOP_ROOT/hive'
export HBASE_HOME='$HADOOP_ROOT/hbase'

##### Kerebros
export KRB5_CONFIG='$HADOOP_ROOT/krb5.conf'
export KEYTAB_FILE='$HADOOP_ROOT/keytabs/myuser.keytab'
export PRINCIPAL='myname@'



##### Spark  conf/spark-env.sh  ##################################################
export SPARK_HOME="/usr/local/spark3/"
export SPARK_CLASSPATH=:$HADOOP_HOME/lib/native/*:$HADOOP_HOME/lib/native/Linux-amd64-64/*:${SPARK_HOME}/jars/*:
export SPARK_SUBMIT_OPTS='-Djava.security.krb5.conf=$HADOOP_ROOT/krb5.conf'
export SPARK_LOCAL_DIR='/tmp'
export SPARK_CONF_DIR= "${SPARK_HOME}/conf"
export SPARK_HISTORY_OPTS=' -Dspark.org.apache.hadoop.security.authentication.server.AuthenticationFilter.params="type=kerberos,kerberos.principalMYNAME,kerberos.keytab=service.keytab"'


export PYSPARK_PYTHON='/opt/anaconda3/bin/python'
export PYTHONPATH="$PYTHONPATH:$REPO"

#export PYSPARK_DRIVER_PYTHON=/usr/bin/python3.6
export PYTHONPATH="$SPARK_HOME/python/lib/py4j-0.10.9-src.zip:$SPARK_HOME/python/lib/pyspark.zip:$SPARK_HOME:$SPARK_HOME/python:"




export PATH='/opt/anaconda3/bin:/opt/anaconda3/condabin:$HADOOP_ROOT/hbase/bin:$HADOOP_ROOT/hive/bin:$HADOOP_ROOT/spark2/bin:$HADOOP_ROOT/jre/bin:$HADOOP_HOME/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:$HADOOP_ROOT/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/anaconda3/bin'



######### Generic options for the daemons used in the standalone deploy mode
export SPARK_LOG_DIR=/var/log/spark2  # Where log files are stored.(Default:${SPARK_HOME}/logs)
export SPARK_PID_DIR=/var/run/spark2  # Where the pid file is stored. (Default: /tmp)
export SPARK_DAEMON_MEMORY=2048m  #Memory for Master, Worker and history server (default: 1024MB)
SPARK_IDENT_STRING=$USER  # A string representing this instance of spark.(Default: $USER)
SPARK_NICENESS=0   # The scheduling priority for daemons. (Default: 0)






##### spark-default.conf    ##################################################################
spark.acls.enable true
spark.admin.acls 
spark.driver.extraClassPath  
spark.driver.extraLibraryPath $HADOOP_ROOT/hadoop/lib/native:$HADOOP_ROOT/hadoop/lib/native/Linux-amd64-64
spark.eventLog.dir hdfs://jpw1ns1/spark2-history
spark.eventLog.enabled true
spark.executor.extraJavaOptions -XX:+UseNUMA
spark.executor.extraLibraryPath /usr/hdp/current/hadoop-client/lib/native:/usr/hdp/current/hadoop-client/lib/native/Linux-amd64-64
spark.extraListeners  
spark.history.fs.cleaner.enabled true
spark.history.fs.cleaner.interval 7d
spark.history.fs.cleaner.maxAge 90d
spark.history.fs.logDirectory hdfs://spark2-history
spark.history.kerberos.enabled true
spark.history.kerberos.keytab /etc/security/keytabs/spark.service.keytab
spark.history.kerberos.principal Myname
spark.history.provider org.apache.spark.deploy.history.FsHistoryProvider
spark.history.store.path /var/lib/spark2/shs_db
spark.history.ui.acls.enable true
spark.history.ui.admin.acls 
spark.history.ui.port 18081
spark.io.compression.lz4.blockSize 128kb
spark.master yarn
spark.shuffle.file.buffer 1m
spark.shuffle.io.backLog 8192
spark.shuffle.io.serverThreads 128
spark.shuffle.unsafe.file.output.buffer 5m
spark.sql.autoBroadcastJoinThreshold 26214400
spark.sql.hive.convertMetastoreOrc true
spark.sql.hive.metastore.jars $HADOOP_ROOT/spark2/standalone-metastore/*
spark.sql.hive.metastore.version 3.0
spark.sql.orc.filterPushdown true
spark.sql.orc.impl native
spark.sql.queryExecutionListeners  
spark.sql.statistics.fallBackToHdfs true
spark.sql.streaming.streamingQueryListeners  
spark.sql.warehouse.dir /apps/spark/warehouse
spark.unsafe.sorter.spill.reader.buffer.size 1m

######
spark.yarn.dist.files  
spark.yarn.historyServer.address  myyarn:18081
spark.yarn.queue common2

### extra
spark.hadoop.yarn.timeline-service.enabled false


# To access Hive
spark.hadoop.hive.llap.daemon.service.hosts @llap0
spark.sql.hive.hiveserver2.jdbc.url jdbc:hive2://hdp-jz6001.haas.jpw1a.dcnw.zzzzzzz:2181,hdp-jz6002.haas.jpw1a.dcnw.zzzzzzz:2181,hdp-jz6003.haas.jpw1a.dcnw.zzzzzzz:2181/hive_testdb;serviceDiscoveryMode=zooKeeperHA;zooKeeperNamespace=hs2ActivePassiveHA
spark.datasource.hive.warehouse.load.staging.dir /tmp
spark.datasource.hive.warehouse.metastoreUri thrift://hdp-hive6001.haas.jpw1a.dcnw.zzzzzzz:9083,thrift://hdp-hive6002.haas.jpw1a.dcnw.zzzzzzz:9083
spark.security.credentials.hiveserver2.enabled false
spark.sql.hive.hiveserver2.jdbc.url.principal hive/_HOST@JP.HADOOP.zzzzzzz.COM
spark.hadoop.hive.zookeeper.quorum hdp-jz6001.haas.jpw1a.dcnw.zzzzzzz:2181,hdp-jz6002.haas.jpw1a.dcnw.zzzzzzz:2181,hdp-jz6003.haas.jpw1a.dcnw.zzzzzzz:2181

### Hive setup
spark.sql.catalogImplementation            hive
spark.hadoop.metastore.catalog.default hive



spark.executor.extraClassPath $HADOOP_ROOT/json-serde-1.3.8-jar-with-dependencies.jar
spark.jars $HADOOP_ROOT/hive_warehouse_connector/hive-warehouse-connector-assembly-1.0.0.3.1.4.0-315.jar,$HADOOP_ROOT/hive/lib/hive-serde-3.1.0.3.1.4.0-315.jar
spark.driver.extraClassPath '$HADOOP_ROOT/hadoop/lib/hadoop-lzo-0.6.0.3.1.4.0-315.jar'
spark.driver.extraLibraryPath '$HADOOP_ROOT/hadoop/lib/native:$HADOOP_ROOT/hadoop/lib/native/Linux-amd64-64'
spark.yarn.cluster.driver.extraLibraryPath '$HADOOP_ROOT/hadoop/lib/native:$HADOOP_ROOT/hadoop/lib/native/Linux-amd64-64'




###### YAML Config  #############################################################################
timezone: Asia

spark_yarn_config: 
  spark.master                              : 'yarn'
  spark.yarn.queue                          : 'common3'
  spark.sql.warehouse.dir                    : '/tmp'
  spark.app.name                             : 'myapp'
  spark.serializer                           : org.apache.spark.serializer.KryoSerializer
  spark.kryoserializer.buffer.max            : 2000mb
  spark.driver.maxResultSize                 : '9g'
  spark.driver.memory                        : '12g'
  spark.executor.instances                   : '90'
  spark.executor.cores                       : '4'
  spark.executor.memory                      : '12g'
  spark.default.parallelism                  : '900'
  spark.sql.shuffle.partitions               : '90'
  spark.driver.extraJavaOptions              : '-Dhdp.version=3.1.4.0-315'
  spark.driver.defaultJavaOptions            : '-Dhdp.version=3.1.4.0-315'
  spark.sql.catalogImplementation            : 'hive'
  spark.rdd.compress                         : 'True'
  spark.serializer.objectStreamReset         : '100'
  spark.hadoop.yarn.timeline-service.enabled : False
  spark.executor.extraJavaOptions            : '-Dhdp.version=3.1.4.0-315'
  spark.executor.defaultJavaOptions          : '-Dhdp.version=3.1.4.0-315'
  spark.yarn.am.extraJavaOptions             : '-Dhdp.version=3.1.4.0-315'
  # spark.executor.extraClassPath            : '$HADOOP_ROOT/json-serde-1.3.8-jar-with-dependencies.jar'
  spark.executor.extraClassPath              : '$HADOOP_ROOT/json-serde.jar'
  
  spark.jars                                 : '$HADOOP_ROOT/hive_warehouse_connector/hive-warehouse-connector-assembly-1.0.0.3.1.4.0-315.jar,$HADOOP_ROOT/hive/lib/hive-serde-3.1.0.3.1.4.0-315.jar,$HADOOP_HOME/lib/hadoop-lzo-0.6.0.3.1.4.0-315.jar'
  #spark.jars                                : 'file://$HADOOP_ROOT/hive_warehouse_connector/hive-warehouse-connector-assembly-1.0.0.3.1.4.0-315.jar,file://$HADOOP_ROOT/hive/lib/hive-serde-3.1.0.3.1.4.0-315.jar'
  spark.hadoop.metastore.catalog.default     : 'hive'
  spark.driver.extraClassPath                : '$HADOOP_HOME/lib/hadoop-lzo-0.6.0.3.1.4.0-315.jar'
  spark.driver.extraLibraryPath              : '$HADOOP_HOME/lib/native:$HADOOP_HOME/lib/native/Linux-amd64-64'
  spark.yarn.cluster.driver.extraLibraryPath : '$HADOOP_HOME/lib/native:$HADOOP_HOME/lib/native/Linux-amd64-64'
  json_jar_path                              : '$HADOOP_ROOT/json-serde.jar'



spark_local_config: 
  spark.master                               : 'local[*]'
  spark.sql.warehouse.dir                    : '/tmp'
  spark.app.name                             : 'myapp'
  spark.serializer                           : org.apache.spark.serializer.KryoSerializer
  spark.kryoserializer.buffer.max            : 2000mb
  spark.driver.maxResultSize                 : '9g'
  spark.driver.memory                        : '12g'
  spark.executor.instances                   : '90'
  spark.executor.cores                       : '4'
  spark.executor.memory                      : '12g'
  spark.default.parallelism                  : '900'
  spark.sql.shuffle.partitions               : '90'
  spark.driver.extraJavaOptions              : '-Dhdp.version=3.1.4.0-315'
  spark.driver.defaultJavaOptions            : '-Dhdp.version=3.1.4.0-315'
  spark.sql.catalogImplementation            : 'hive'
  spark.rdd.compress                         : 'True'
  spark.serializer.objectStreamReset         : '100'
  spark.hadoop.yarn.timeline-service.enabled : False
  spark.executor.extraJavaOptions            : '-Dhdp.version=3.1.4.0-315'
  spark.executor.defaultJavaOptions          : '-Dhdp.version=3.1.4.0-315'
  spark.yarn.am.extraJavaOptions             : '-Dhdp.version=3.1.4.0-315'
  # spark.executor.extraClassPath            : '$HADOOP_ROOT/json-serde-1.3.8-jar-with-dependencies.jar'
  spark.executor.extraClassPath              : '$HADOOP_ROOT/json-serde.jar'
  
  spark.jars                                 : '$HADOOP_ROOT/hive_warehouse_connector/hive-warehouse-connector-assembly-1.0.0.3.1.4.0-315.jar,$HADOOP_ROOT/hive/lib/hive-serde-3.1.0.3.1.4.0-315.jar,$HADOOP_HOME/lib/hadoop-lzo-0.6.0.3.1.4.0-315.jar'
  #spark.jars                                : 'file://$HADOOP_ROOT/hive_warehouse_connector/hive-warehouse-connector-assembly-1.0.0.3.1.4.0-315.jar,file://$HADOOP_ROOT/hive/lib/hive-serde-3.1.0.3.1.4.0-315.jar'
  spark.hadoop.metastore.catalog.default     : 'hive'
  spark.driver.extraClassPath                : '$HADOOP_HOME/lib/hadoop-lzo-0.6.0.3.1.4.0-315.jar'
  spark.driver.extraLibraryPath              : '$HADOOP_HOME/lib/native:$HADOOP_HOME/lib/native/Linux-amd64-64'
  spark.yarn.cluster.driver.extraLibraryPath : '$HADOOP_HOME/lib/native:$HADOOP_HOME/lib/native/Linux-amd64-64'
  json_jar_path                              : '$HADOOP_ROOT/json-serde.jar'




export PYSPARK_PYTHON="./CONDA_ENV/bin/python"
export PYSPARK_DRIVER_PYTHON=$PYSPARK_PYTHON
export KEYTAB=$DIRECTORY/aa.prod.keytab
export ZIP_CONDA_PATH=$HOME/.envs/base_env.zip


spark-submit --master yarn \
             --deploy-mode cluster \
             --num-executors 100 \
             --executor-cores 5 \
             --executor-memory 8g \
             --queue common2 \
             --files hive-site.xml \
             --conf spark.executor.memoryOverhead=8g \
             --conf spark.sql.shuffle.partitions=2000 \
             --conf spark.driver.memory=8g \
             --conf spark.yarn.maxAppAttempts=1 \
             --conf spark.yarn.keytab="$KEYTAB" \
             --conf spark.yarn.principal="$PRINCIPAL" \
             --conf spark.yarn.dist.archives=$ZIP_CONDA_PATH#CONDA_ENV,/opt/resources.tar.gz#IRESOURCES \
             mymainy.py --look_back 30
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           


