import{x as u,r as i,y as m,t as c,j as e,z as y,M as j,A as v,D as f,E as g,g as p,F as d,G as A,H as E,I as T,u as b,J as l,B as C,k as P,l as w,m as M,n as S,p as B,T as D,C as L,s as k,b as N,L as F,U as H,v as O}from"./index-Be3uPtkT.js";import{a as x}from"./supportedProviders-ByaiBbPk.js";import"./logo_microsoft-CP2bHIYw.js";function V(){const{isOpen:s,open:o,close:r}=u(),[a,t]=i.useState(null),n=m(),h=()=>{t(null),r()};return i.useEffect(()=>{a&&n(c(a.id,"create"))},[a,n]),e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"btn-primary",onClick:o,children:"Add New"}),e.jsxs(j,{isOpen:s,close:h,className:"max-w-4xl h-3/4",children:[e.jsx(v,{children:"Select provider type"}),e.jsx(_,{onSelected:t})]})]})}function _({onSelected:s}){const o=[];for(const r of x.getAllProviders())r.create.component&&o.push({name:r.name,description:r.description??"",icon:r.icon,id:r.id});return e.jsx(f,{items:o,onSelected:s})}function q({id:s,type:o}){const r=u(),a=g({mutationFn:()=>{const t=x.getProviderByType(o);if(!t)throw new Error("Delete provider - can't find provider type definition");if(!t.delete.route)throw new Error("The provider can't be deleted because the delete route is not defined.");return p.delete(c(t.delete.route,s))},onSuccess:()=>d.success("The provider was deleted"),onError:t=>d.error(A(t).message)});return e.jsxs(e.Fragment,{children:[e.jsx(E,{onClick:()=>r.setOpen(!0)}),e.jsx(T,{isOpen:r.isOpen,close:r.close,message:"Are you sure you want to delete this entry?",action:()=>a.mutate()})]})}function I({cell:s}){const o=s.row.getValue("entity_type"),r=s.row.getValue("id");return e.jsxs(N,{className:"flex gap-2",children:[e.jsx(F,{to:c(o,r,"update"),children:e.jsx(H,{})}),e.jsx(q,{type:o,id:r})]})}function G(){const s=b({queryKey:["providers"],queryFn:()=>p.get("/api/providers").then(t=>t.data)}),o=i.useMemo(()=>{const t=O();return[t.accessor("name",{header:"Name"}),t.accessor("description",{header:"Description"}),t.accessor("entity_type",{header:"Type"}),t.accessor("is_enabled",{header:"Enabled",cell:n=>e.jsx(l,{value:n.getValue()})}),t.accessor("is_deletable",{header:"Deletable",cell:n=>e.jsx(l,{value:n.getValue()})}),t.accessor("id",{header:"Actions",cell:({cell:n})=>e.jsx(I,{cell:n})})]},[]),a={data:i.useMemo(()=>s.data??[],[s.data]),columns:o,enablePagination:!0};return e.jsx(C,{children:e.jsxs(P,{children:[e.jsxs(w,{divider:!0,children:[e.jsx(M,{description:"Here you can create or modify authentication sources",children:"Authentication Providers"}),e.jsx(S,{children:e.jsx(V,{})})]}),e.jsxs(B,{children:[s.isSuccess&&e.jsx(D,{...a}),s.isPending&&e.jsx(L,{}),s.isError&&e.jsx(k,{error:s.error})]})]})})}export{G as default};
