import{j as e,K as d,k as N,b as s,O as f,P as w,Q as i,R as y,V as F,W as _,L as g,t as q,X as C,Y as A,Z as P,_ as I,E as L,$ as M,a0 as u,a1 as R,a2 as B,g as S,a3 as D,a4 as G,u as H,C as T,a5 as b}from"./index-Be3uPtkT.js";const E="/assets/setup_logo-Ccs78RPX.svg";function U({progress:o}){const t="/admin";return e.jsx(d,{className:"min-h-screen bg-base-200",children:e.jsxs(N,{className:"mx-auto max-w-lg shadow-none bg-base-none",children:[e.jsxs(s,{className:"py-16 px-10 shadow-xl bg-base-100 rounded-xl",children:[e.jsxs(s,{className:"text-center",children:[e.jsx(f,{src:E,className:"mb-2 h-32 m-auto",alt:"Setup logo"}),e.jsx(w,{className:"text-3xl font-semibold mb-2 ",children:"Setup is complete!"}),e.jsxs(i,{children:["You are now ready to explore the full potential of ",y,"!"]})]}),e.jsx(s,{className:"divider uppercase text-xs",children:"What's Next?"}),e.jsxs(s,{className:"mb-3",children:[e.jsx(s,{className:"mb-2",children:e.jsx(F,{className:"link link-primary",href:_,children:"Check out the documentation"})}),e.jsx(i,{children:"For an in-depth understanding of the features and capabilities, check out the documentation on GitHub."})]}),e.jsxs(s,{children:[e.jsx(s,{className:"mb-2",children:e.jsx(g,{className:"link link-primary",to:q(t,"/datasources/devices"),children:"Configure Your Data Sources"})}),e.jsx(i,{children:"Add your firewalls, IPAM and SIEM to gain a full understanding of the network."})]})]}),e.jsxs(s,{className:"flex items-center mt-4",children:[e.jsx(s,{className:"flex-1",children:e.jsx(C,{className:"progress-primary w-36",value:o,max:"100"})}),e.jsx(g,{className:"btn btn-primary",to:t,children:"Admin Dashboard"})]})]})})}function W({progress:o,successCallback:t}){var x,h,p,j;const{register:a,formState:{errors:n},handleSubmit:l,setError:c}=A(),k=P(I(r=>({signin:r.signin}))),v=L({mutationFn:async r=>{await S.post("/api/setup/user",r),await k.signin({username:r.email,password:r.password,scope:""})},onSuccess:()=>t&&t(),onError:r=>c(...D(r))}),m={required:{value:!0,message:G.fieldRequired}};return e.jsx(d,{className:"min-h-screen bg-base-200",children:e.jsx(N,{className:"mx-auto max-w-lg shadow-none bg-base-none",children:e.jsxs(M,{onSubmit:l(r=>v.mutate(r)),children:[e.jsxs(s,{className:"py-16 px-10 shadow-xl bg-base-100 rounded-xl",children:[e.jsxs(s,{className:"text-center",children:[e.jsx(f,{src:E,className:"mb-2 h-32 m-auto",alt:"Setup logo"}),e.jsxs(w,{className:"text-3xl font-semibold mb-2 ",children:["Welcome to ",y,"!"]}),e.jsx(i,{children:"Collect logs from various sources across your network infrastructure and enhance them with metadata."})]}),e.jsx(s,{className:"divider uppercase text-xs",children:"Create admin user"}),e.jsx(u,{...a("name",m),error:(x=n.name)==null?void 0:x.message,containerClassName:"mt-4",title:"Name",required:!0}),e.jsx(u,{...a("email",m),error:(h=n.email)==null?void 0:h.message,type:"email",containerClassName:"mt-4",title:"Email",required:!0}),e.jsx(u,{...a("password",m),error:(p=n.password)==null?void 0:p.message,type:"password",containerClassName:"mt-4",title:"Password",required:!0}),e.jsx(R,{children:(j=n.root)==null?void 0:j.message})]}),e.jsxs(s,{className:"flex items-center mt-4",children:[e.jsx(s,{className:"flex-1",children:e.jsx(C,{className:"progress-primary w-36",value:o,max:"100"})}),e.jsx(B,{className:"btn btn-primary ",children:"Create"})]})]})})})}function K(){const{isLoading:o,isError:t,data:a,refetch:n}=H({queryKey:["setupState"],queryFn:()=>S.get("/api/setup/state").then(c=>c.data)});if(o)return e.jsx(d,{className:"min-h-screen",children:e.jsx(T,{size:20})});if(t)return e.jsx(b,{description:"Failed to load setup state"});const l=()=>{n()};switch(!0){case(a==null?void 0:a.is_initial_user_created)!==!0:return e.jsx(W,{progress:50,successCallback:l});case(a==null?void 0:a.is_setup_complete)===!0:return e.jsx(U,{progress:100});default:return e.jsx(b,{description:"Invalid setup state - The current setup state doesn't match any of the available options."})}}export{K as default};
