import{j as e,ai as fe,aj as Ce,ak as _e,am as ye,ar as L,b as l,as as J,an as g,a0 as B,ab as q,ah as Z,a4 as ee,at as P,Y as j,E as p,g as d,au as c,a3 as S,B as f,a as C,$ as _,a1 as y,av as I,u as F,t as x,s as T,C as E,r as D,G as W,aw as R,ax as k,K as Ie,P as we,Q as be,O as V}from"./index-Be3uPtkT.js";import{CredentialsFormSelect as Ae}from"./index-ZAiMN538.js";function Y({children:n}){return e.jsxs(fe,{className:"collapse-arrow",type:"checkbox",children:[e.jsx(Ce,{children:"Information"}),e.jsx(_e,{className:"prose",children:e.jsx(ye,{children:n})})]})}function U({title:n="Data Source preparation",children:a}){return e.jsxs(e.Fragment,{children:[e.jsx(L,{children:n}),e.jsx(l,{className:"prose",children:e.jsx(J,{children:a})})]})}function M(){return e.jsx(g,{children:"To ensure proper certificate verification for SSL connections, the CA certificate used to sign the server's certificate must be imported into the system's CA certificate store."})}function ve({min:n,max:a,versions:s}){return e.jsxs(g,{children:[s&&e.jsxs(l,{children:["Supported versions:",e.jsx(l,{as:"span",className:"text-red-600 ms-1",children:s})]}),n&&e.jsxs(l,{children:["Minimum supported version:",e.jsx(l,{as:"span",className:"text-red-600 ms-1",children:n})]}),a&&e.jsxs(l,{children:["Maximum supported version:",e.jsx(l,{as:"span",className:"text-red-600 ms-1",children:a})]})]})}function w({methods:n,formFieldParams:a,credentialFormConfig:s,feature_certificate:r=!0}){var G,Q,K,O,X,$;const i={required:{value:!0,message:ee.fieldRequired}},{register:t,formState:{errors:u},setValue:m}=P(n),o=Se=>setTimeout(()=>m("credential_profile_id",Se),200);return e.jsxs(e.Fragment,{children:[e.jsx(L,{children:"General"}),e.jsx(B,{...a==null?void 0:a.name,...t("name",i),type:"text",title:"Name",error:(G=u.name)==null?void 0:G.message,required:!0}),e.jsx(B,{...a==null?void 0:a.description,...t("description"),title:"Description",error:(Q=u.description)==null?void 0:Q.message}),e.jsx(B,{...a==null?void 0:a.host,...t("host",i),title:"Host",error:(K=u.host)==null?void 0:K.message,required:!0}),e.jsx(Ae,{...a==null?void 0:a.credential_profile_id,...t("credential_profile_id",i),createNewProfileCallback:o,error:(O=u.credential_profile_id)==null?void 0:O.message,formConfig:s,required:!0}),r&&e.jsx(q,{...t("is_certificate_validation_enabled"),error:(X=u.is_certificate_validation_enabled)==null?void 0:X.message,titlePosition:"after",title:"Verify SSL Certificate",...a==null?void 0:a.is_certificate_validation_enabled}),e.jsx(q,{...a==null?void 0:a.is_enabled,...t("is_enabled"),error:($=u.is_enabled)==null?void 0:$.message,title:"Enabled",titlePosition:"after"})]})}function A({methods:n,formFieldParams:a}){var i;const{register:s,formState:{errors:r}}=P(n);return e.jsxs(e.Fragment,{children:[e.jsx(L,{children:"Logs"}),e.jsxs(l,{className:"flex items-center",children:[e.jsx(q,{...a==null?void 0:a.is_log_fetching_enabled,...s("is_log_fetching_enabled"),error:(i=r.is_log_fetching_enabled)==null?void 0:i.message,title:"Enable log fetching",titlePosition:"after"}),e.jsx(Z,{message:"Enabling this option will allow you to fetch logs from this data source."})]})]})}function b({methods:n,formFieldParams:a}){var t,u,m;const s={required:{value:!0,message:ee.fieldRequired}},{register:r,formState:{errors:i}}=P(n);return e.jsxs(e.Fragment,{children:[e.jsx(L,{children:"Asset"}),e.jsx(B,{...a==null?void 0:a.asset_collection_interval,...r("asset_collection_interval",{...s,min:{value:1,message:"Input should be more than or equal to 1"},max:{value:1440,message:"Input should be less than or equal to 1440"}}),error:(t=i.asset_collection_interval)==null?void 0:t.message,type:"number",title:"Collection Interval",description:"Specify the interval (in minutes) for asset collection."}),e.jsx(B,{...a==null?void 0:a.priority,...r("priority",{...s,min:{value:1,message:"Input should be more than or equal to 1"},max:{value:10,message:"Input should be less than or equal to 10"}}),error:(u=i.priority)==null?void 0:u.message,type:"number",title:"Priority",description:"In cases where multiple sources provide a value for the same asset, the source with the higher priority takes precedence"}),e.jsxs(l,{className:"flex items-center",children:[e.jsx(q,{...a==null?void 0:a.is_asset_collection_enabled,...r("is_asset_collection_enabled"),error:(m=i.is_asset_collection_enabled)==null?void 0:m.message,title:"Enable asset collection",titlePosition:"after"}),e.jsx(Z,{message:"Enabling this option will allow you to collect asset information from this data source."})]})]})}function te({handleSubmit:n,itemId:a}){const[s,r]=D.useState(""),i=p({mutationFn:async t=>d.post(h.getDataSourceByType(c.ARIA_LOGS).validate.route,t).then(()=>r("Success")),onError:t=>r(W(t).message)});return e.jsx(R,{onClick:n(t=>i.mutate({config:t,item_id:a})),isPending:i.isPending,isSuccess:i.isSuccess,result:s})}function se(){return e.jsxs(l,{children:[e.jsxs(Y,{children:[e.jsx(M,{}),e.jsx(g,{children:'This data source currently supports only NSX logs. To enable proper search functionality for NSX logs, the "VMware NSX" Content Pack is required.'})]}),e.jsxs(U,{title:"Prepare credentials",children:[e.jsx(g,{children:"Log in to Aria Logs and create a new user (Read-Only permissions)"}),e.jsx(g,{children:"Install Aria Logs Content Pack - VMware NSX"}),e.jsx(g,{children:"Create a new credential profile and add username, password and domain fields"}),e.jsxs(g,{children:["The domain field specifies the account type, which can be one of the following:",e.jsx(k,{children:" Local"}),", ",e.jsx(k,{children:"ActiveDirectory"})," or ",e.jsx(k,{children:"vIDM"}),"."]})]})]})}const re={formFieldParams:{token:{visible:!1},domain:{placeholder:"Account type - 'Local' or 'ActiveDirectory' or 'vIDM'"}}};function Ve({successCallback:n,cancelCallback:a}){var i;const s=j({defaultValues:{is_enabled:!0,is_log_fetching_enabled:!0}}),r=p({mutationFn:t=>d.post(h.getDataSourceByType(c.ARIA_LOGS).create.route,t),onSuccess:()=>n(),onError:t=>s.setError(...S(t))});return e.jsxs(f,{children:[e.jsx(C,{children:"Create Aria Logs Data Source"}),e.jsxs(l,{className:"lg:max-w-3xl",children:[e.jsx(se,{}),e.jsxs(_,{onSubmit:s.handleSubmit(t=>r.mutate(t)),children:[e.jsx(w,{methods:s,formFieldParams:{host:{placeholder:"https://arialogs.corp.com:9543"},is_certificate_validation_enabled:{title:"Verify SSL Certificate"}},credentialFormConfig:re}),e.jsx(A,{methods:s}),e.jsx(te,{handleSubmit:s.handleSubmit}),e.jsx(y,{children:(i=s.formState.errors.root)==null?void 0:i.message}),e.jsx(I,{cancelBtnName:"Discard",submitBtnName:"Create",onCancel:a,isPending:r.isPending})]})]})]})}function Ne({id:n,values:a,successCallback:s,cancelCallback:r,className:i}){var m;const t=j({defaultValues:a}),u=p({mutationFn:o=>d.put(x(h.getDataSourceByType(c.ARIA_LOGS).update.route,n),o),onSuccess:()=>s(),onError:o=>t.setError(...S(o))});return e.jsxs(_,{className:i,onSubmit:t.handleSubmit(o=>u.mutate(o)),children:[e.jsx(w,{methods:t,formFieldParams:{host:{placeholder:"https://arialogs.corp.com:9543"},is_certificate_validation_enabled:{title:"Verify SSL Certificate"}},credentialFormConfig:re}),e.jsx(A,{methods:t}),e.jsx(te,{handleSubmit:t.handleSubmit,itemId:n}),e.jsx(y,{children:(m=t.formState.errors.root)==null?void 0:m.message}),e.jsx(I,{cancelBtnName:"Cancel",submitBtnName:"Save Changes",onCancel:r,isPending:u.isPending})]})}function Fe({id:n,successCallback:a,cancelCallback:s}){const r=F({queryKey:["data_sources",n],queryFn:()=>d.get(x(h.getDataSourceByType(c.ARIA_LOGS).get.route,n)).then(i=>i.data)});if(r.isError)return e.jsx(T,{error:r.error});if(r.isPending)return e.jsx(E,{});if(r.data)return e.jsxs(f,{children:[e.jsx(C,{children:"Update Aria Logs Data Source"}),e.jsxs(l,{className:"lg:max-w-3xl",children:[e.jsx(se,{}),e.jsx(Ne,{id:n,values:r.data,successCallback:a,cancelCallback:s})]})]})}function ae({handleSubmit:n,itemId:a}){const[s,r]=D.useState(""),i=p({mutationFn:async t=>d.post(h.getDataSourceByType(c.ARIA_NETWORKS).validate.route,t).then(()=>r("Success")),onError:t=>r(W(t).message)});return e.jsx(R,{onClick:n(t=>i.mutate({config:t,item_id:a})),isPending:i.isPending,isSuccess:i.isSuccess,result:s})}function ne(){return e.jsxs(l,{children:[e.jsxs(Y,{children:[e.jsx(M,{}),e.jsx(ve,{min:"v6.14"})]}),e.jsxs(U,{title:"Prepare credentials",children:[e.jsx(g,{children:"Log in to Aria Networks and create a new user (Read-Only permissions)"}),e.jsx(g,{children:"Create a new credential profile and add username, password and domain fields"}),e.jsxs(g,{children:["The domain field specifies the account type, which can be one of the following:",e.jsx(k,{children:" LOCAL"})," or ",e.jsx(k,{children:"LDAP"}),"."]})]})]})}const ie={formFieldParams:{token:{visible:!1},domain:{placeholder:"LOCAL or LDAP"}}};function Te({successCallback:n,cancelCallback:a}){var i;const s=j({defaultValues:{is_enabled:!0,is_log_fetching_enabled:!0,is_asset_collection_enabled:!0,asset_collection_interval:5,priority:5}}),r=p({mutationFn:t=>d.post(h.getDataSourceByType(c.ARIA_NETWORKS).create.route,t),onSuccess:()=>n(),onError:t=>s.setError(...S(t))});return e.jsxs(f,{children:[e.jsx(C,{children:"Create Aria Networks Data Source"}),e.jsxs(l,{className:"lg:max-w-3xl",children:[e.jsx(ne,{}),e.jsxs(_,{onSubmit:s.handleSubmit(t=>r.mutate(t)),children:[e.jsx(w,{methods:s,formFieldParams:{host:{placeholder:"https://arianetworks.corp.com"},is_certificate_validation_enabled:{title:"Verify SSL Certificate"}},credentialFormConfig:ie}),e.jsx(A,{methods:s}),e.jsx(b,{methods:s}),e.jsx(ae,{handleSubmit:s.handleSubmit}),e.jsx(y,{children:(i=s.formState.errors.root)==null?void 0:i.message}),e.jsx(I,{cancelBtnName:"Discard",submitBtnName:"Create",onCancel:a,isPending:r.isPending})]})]})]})}function Ee({id:n,values:a,successCallback:s,cancelCallback:r,className:i}){var m;const t=j({defaultValues:a}),u=p({mutationFn:o=>d.put(x(h.getDataSourceByType(c.ARIA_NETWORKS).update.route,n),o),onSuccess:()=>s(),onError:o=>t.setError(...S(o))});return e.jsxs(_,{className:i,onSubmit:t.handleSubmit(o=>u.mutate(o)),children:[e.jsx(w,{methods:t,formFieldParams:{host:{placeholder:"https://arianetworks.corp.com"},is_certificate_validation_enabled:{title:"Verify SSL Certificate"}},credentialFormConfig:ie}),e.jsx(A,{methods:t}),e.jsx(b,{methods:t}),e.jsx(ae,{handleSubmit:t.handleSubmit,itemId:n}),e.jsx(y,{children:(m=t.formState.errors.root)==null?void 0:m.message}),e.jsx(I,{cancelBtnName:"Cancel",submitBtnName:"Save Changes",onCancel:r,isPending:u.isPending})]})}function De({id:n,successCallback:a,cancelCallback:s}){const r=F({queryKey:["data_sources",n],queryFn:()=>d.get(x(h.getDataSourceByType(c.ARIA_NETWORKS).get.route,n)).then(i=>i.data)});if(r.isError)return e.jsx(T,{error:r.error});if(r.isPending)return e.jsx(E,{});if(r.data)return e.jsxs(f,{children:[e.jsx(C,{children:"Update Aria Networks Data Source"}),e.jsxs(l,{className:"lg:max-w-3xl",children:[e.jsx(ne,{}),e.jsx(Ee,{id:n,values:r.data,successCallback:a,cancelCallback:s})]})]})}const We="/assets/device_aria_logs-Dq5JUNPi.png",Re="/assets/device_aria_networks-DWqREGSA.png",Ye="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAD9QTFRFAAAA2i8o2i0n4zkr2y0n2S0n2y8q2y0o2i4o3C4p2S8r2i4o2i4p2y4n2i4n2jAp2S0o2i4o5jMz2zEo/0BAoyDnuQAAABV0Uk5TAFL4ElX/MZOmLDall1TqS+bTCjkE+OfGpwAAAvpJREFUeJzt0EFKA1EQRdH+IIEIIrj/PQbEgQMN6SX07UnRcO78UcVZmw63ph+4UrBCsEKwQrBCsEKwQmtbvA62S73BOtgT1vFghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFdqzb5bDW/8zd5+Wk9u5/M3dhhWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghWCFYIVghXas9xmv9XN6Ooj18Tty+f59fgorTGGFKawwhRWmsMIUVpjCClNYYQorTGGFKawwhRWmsMIUVpjCClNYYQorTGGFKawwhRWmsMIUVpjCClNYYQorTGGFKawwhRWmsMIUVpjCClNYYQorTGGFKawwhRWmsMIUVpjCClNYYQorTGGFKawwhRWmsMIUVpjCClNYYQorTGGFKawwhRWmsMIUVpjCClNYYQorTGGFKawwhRWmsMIUVpjCClNYYQorTGGFKawwhRWmsMIUVpjCClNYYQorTGGFKawwhRWmsMIUVpjCClNYYQorTGGFKawwhRWmsMIUVpjCClNYYQorTGGFKawwhRWmsMIUVpjCClNYYQorTGGFKawwhRWmsMIUVpjCClNYYQorTGGFKawwhRWmsMIUVpjCCtM5rM81cnk9Tk+/Zj7e1tDdawYrBCsEKwQrBCsEKwQr9AKFj6qwW++IQwAAAABJRU5ErkJggg==",Me="/assets/device_nsx-Qvn6gA3I.png",Be="/assets/device_qradar-hOOjfHyb.webp",ke="/assets/device_vcenter-CWcRnpzx.png";function z(){return e.jsx(Ie,{className:"h-full text-center",children:e.jsxs(l,{className:"max-w-md",children:[e.jsx(we,{as:"h1",className:"text-3xl font-bold",children:"Not Allowed"}),e.jsx(be,{className:"py-6",children:"This data source is part of the demo setup and cannot be modified."})]})})}function oe({handleSubmit:n,itemId:a}){const[s,r]=D.useState(""),i=p({mutationFn:async t=>d.post(h.getDataSourceByType(c.IVANTI_ITSM).validate.route,t).then(()=>r("Success")),onError:t=>r(W(t).message)});return e.jsx(R,{onClick:n(t=>i.mutate({config:t,item_id:a})),isPending:i.isPending,isSuccess:i.isSuccess,result:s})}function ce(){return e.jsxs(l,{children:[e.jsxs(Y,{children:[e.jsx(M,{}),e.jsx(g,{children:"Currently, this source only processes CI objects"}),e.jsx(g,{children:"If a CI object contains multiple IP addresses, they should be comma-separated"}),e.jsx(g,{children:"Custom attribute mapping is not yet supported. This feature is planned for a future release"})]}),e.jsx(L,{children:"Prepare credentials"}),e.jsx(l,{className:"prose",children:e.jsxs(J,{children:[e.jsx(g,{children:"Log in to Ivanti and create a new REST API Key"}),e.jsx(g,{children:"Create a new credential profile and add API Key to the 'Token' field."})]})})]})}function Le({successCallback:n,cancelCallback:a}){var i;const s=j({defaultValues:{is_enabled:!0,is_asset_collection_enabled:!0,asset_collection_interval:5,priority:4}}),r=p({mutationFn:t=>d.post(h.getDataSourceByType(c.IVANTI_ITSM).create.route,t),onSuccess:()=>n(),onError:t=>s.setError(...S(t))});return e.jsxs(f,{children:[e.jsx(C,{children:"Create Ivanti ITSM Data Source"}),e.jsxs(l,{className:"lg:max-w-3xl",children:[e.jsx(ce,{}),e.jsxs(_,{onSubmit:s.handleSubmit(t=>r.mutate(t)),children:[e.jsx(w,{methods:s,formFieldParams:{host:{placeholder:"https://ivanti.corp.com",description:"If you are using the HEAT version of ITSM, the host URL should follow this format: https://ivanti.corp.com/HEAT/"},is_certificate_validation_enabled:{title:"Verify SSL Certificate"}}}),e.jsx(b,{methods:s}),e.jsx(oe,{handleSubmit:s.handleSubmit}),e.jsx(y,{children:(i=s.formState.errors.root)==null?void 0:i.message}),e.jsx(I,{cancelBtnName:"Discard",submitBtnName:"Create",onCancel:a,isPending:r.isPending})]})]})]})}function Ue({id:n,values:a,successCallback:s,cancelCallback:r,className:i}){var m;const t=j({defaultValues:a}),u=p({mutationFn:o=>d.put(x(h.getDataSourceByType(c.IVANTI_ITSM).update.route,n),o),onSuccess:()=>s(),onError:o=>t.setError(...S(o))});return e.jsxs(_,{className:i,onSubmit:t.handleSubmit(o=>u.mutate(o)),children:[e.jsx(w,{methods:t,formFieldParams:{host:{placeholder:"https://ivanti.corp.com",description:"If you are using the HEAT version of ITSM, the host URL should follow this format: https://ivanti.corp.com/HEAT/"},is_certificate_validation_enabled:{title:"Verify SSL Certificate"}}}),e.jsx(b,{methods:t}),e.jsx(oe,{handleSubmit:t.handleSubmit,itemId:n}),e.jsx(y,{children:(m=t.formState.errors.root)==null?void 0:m.message}),e.jsx(I,{cancelBtnName:"Cancel",submitBtnName:"Save Changes",onCancel:r,isPending:u.isPending})]})}function qe({id:n,successCallback:a,cancelCallback:s}){const r=F({queryKey:["data_sources",n],queryFn:()=>d.get(x(h.getDataSourceByType(c.IVANTI_ITSM).get.route,n)).then(i=>i.data)});if(r.isError)return e.jsx(T,{error:r.error});if(r.isPending)return e.jsx(E,{});if(r.data)return e.jsxs(f,{children:[e.jsx(C,{children:"Update Ivanti ITSM Data Source"}),e.jsxs(l,{className:"lg:max-w-3xl",children:[e.jsx(ce,{}),e.jsx(Ue,{id:n,values:r.data,successCallback:a,cancelCallback:s})]})]})}function le({handleSubmit:n,itemId:a}){const[s,r]=D.useState(""),i=p({mutationFn:async t=>d.post(h.getDataSourceByType(c.VMWARE_NSX).validate.route,t).then(()=>r("Success")),onError:t=>r(W(t).message)});return e.jsx(R,{onClick:n(t=>i.mutate({config:t,item_id:a})),isPending:i.isPending,isSuccess:i.isSuccess,result:s})}function ue(){return e.jsxs(l,{children:[e.jsxs(Y,{children:[e.jsx(M,{}),e.jsx(g,{children:"Currently, basic authentication using a username and password is the only supported authentication method"})]}),e.jsxs(U,{title:"Prepare credentials",children:[e.jsx(g,{children:"Log in to Vmware NSX-T and create a new user (Read-Only permissions)"}),e.jsx(g,{children:"Create a new credential profile and add username and password fields"})]})]})}const de={formFieldParams:{token:{visible:!1},domain:{visible:!1}}};function Pe({successCallback:n,cancelCallback:a}){var i;const s=j({defaultValues:{is_enabled:!0,is_asset_collection_enabled:!0,asset_collection_interval:5,priority:4}}),r=p({mutationFn:t=>d.post(h.getDataSourceByType(c.VMWARE_NSX).create.route,t),onSuccess:()=>n(),onError:t=>s.setError(...S(t))});return e.jsxs(f,{children:[e.jsx(C,{children:"Create VMware NSX-T Data Source"}),e.jsxs(l,{className:"lg:max-w-3xl",children:[e.jsx(ue,{}),e.jsxs(_,{onSubmit:s.handleSubmit(t=>r.mutate(t)),children:[e.jsx(w,{methods:s,formFieldParams:{host:{placeholder:"https://nsx.corp.com"}},credentialFormConfig:de}),e.jsx(b,{methods:s}),e.jsx(le,{handleSubmit:s.handleSubmit}),e.jsx(y,{children:(i=s.formState.errors.root)==null?void 0:i.message}),e.jsx(I,{cancelBtnName:"Discard",submitBtnName:"Create",onCancel:a,isPending:r.isPending})]})]})]})}function Ge({id:n,values:a,successCallback:s,cancelCallback:r,className:i}){var m;const t=j({defaultValues:a}),u=p({mutationFn:o=>d.put(x(h.getDataSourceByType(c.VMWARE_NSX).update.route,n),o),onSuccess:()=>s(),onError:o=>t.setError(...S(o))});return e.jsxs(_,{className:i,onSubmit:t.handleSubmit(o=>u.mutate(o)),children:[e.jsx(w,{methods:t,formFieldParams:{host:{placeholder:"https://nsx.corp.com"}},credentialFormConfig:de}),e.jsx(A,{methods:t}),e.jsx(b,{methods:t}),e.jsx(le,{handleSubmit:t.handleSubmit,itemId:n}),e.jsx(y,{children:(m=t.formState.errors.root)==null?void 0:m.message}),e.jsx(I,{cancelBtnName:"Cancel",submitBtnName:"Save Changes",onCancel:r,isPending:u.isPending})]})}function Qe({id:n,successCallback:a,cancelCallback:s}){const r=F({queryKey:["data_sources",n],queryFn:()=>d.get(x(h.getDataSourceByType(c.VMWARE_NSX).get.route,n)).then(i=>i.data)});if(r.isError)return e.jsx(T,{error:r.error});if(r.isPending)return e.jsx(E,{});if(r.data)return e.jsxs(f,{children:[e.jsx(C,{children:"Update VMware NSX-T Data Source"}),e.jsxs(l,{className:"lg:max-w-3xl",children:[e.jsx(ue,{}),e.jsx(Ge,{id:n,values:r.data,successCallback:a,cancelCallback:s})]})]})}function he({handleSubmit:n,itemId:a}){const[s,r]=D.useState(""),i=p({mutationFn:async t=>d.post(h.getDataSourceByType(c.QRADAR).validate.route,t).then(()=>r("Success")),onError:t=>r(W(t).message)});return e.jsx(R,{onClick:n(t=>i.mutate({config:t,item_id:a})),isPending:i.isPending,isSuccess:i.isSuccess,result:s})}function me(){return e.jsxs(l,{children:[e.jsx(Y,{children:e.jsx(M,{})}),e.jsxs(U,{title:"Prepare credentials",children:[e.jsx(g,{children:"Log in to QRadar and create a new API Key"}),e.jsx(g,{children:"Create a new credential profile and add API Key to the 'Token' field."})]})]})}const ge={formFieldParams:{password:{visible:!1},domain:{visible:!1},username:{visible:!1}}};function Ke({successCallback:n,cancelCallback:a}){var i;const s=j({defaultValues:{is_enabled:!0,is_log_fetching_enabled:!0,is_asset_collection_enabled:!0,asset_collection_interval:5,priority:3}}),r=p({mutationFn:t=>d.post(h.getDataSourceByType(c.QRADAR).create.route,t),onSuccess:()=>n(),onError:t=>s.setError(...S(t))});return e.jsxs(f,{children:[e.jsx(C,{children:"Create QRadar Data Source"}),e.jsxs(l,{className:"lg:max-w-3xl",children:[e.jsx(me,{}),e.jsxs(_,{onSubmit:s.handleSubmit(t=>r.mutate(t)),children:[e.jsx(w,{methods:s,formFieldParams:{host:{placeholder:"https://qradar.corp.com"},is_certificate_validation_enabled:{title:"Verify SSL Certificate"}},credentialFormConfig:ge}),e.jsx(A,{methods:s}),e.jsx(b,{methods:s}),e.jsx(he,{handleSubmit:s.handleSubmit}),e.jsx(y,{children:(i=s.formState.errors.root)==null?void 0:i.message}),e.jsx(I,{cancelBtnName:"Discard",submitBtnName:"Create",onCancel:a,isPending:r.isPending})]})]})]})}function Oe({id:n,values:a,successCallback:s,cancelCallback:r,className:i}){var m;const t=j({defaultValues:a}),u=p({mutationFn:o=>d.put(x(h.getDataSourceByType(c.QRADAR).update.route,n),o),onSuccess:()=>s(),onError:o=>t.setError(...S(o))});return e.jsxs(_,{className:i,onSubmit:t.handleSubmit(o=>u.mutate(o)),children:[e.jsx(w,{methods:t,formFieldParams:{host:{placeholder:"https://qradar.corp.com"},is_certificate_validation_enabled:{title:"Verify SSL Certificate"}},credentialFormConfig:ge}),e.jsx(A,{methods:t}),e.jsx(b,{methods:t}),e.jsx(he,{handleSubmit:t.handleSubmit,itemId:n}),e.jsx(y,{children:(m=t.formState.errors.root)==null?void 0:m.message}),e.jsx(I,{cancelBtnName:"Cancel",submitBtnName:"Save Changes",onCancel:r,isPending:u.isPending})]})}function Xe({id:n,successCallback:a,cancelCallback:s}){const r=F({queryKey:["data_sources",n],queryFn:()=>d.get(x(h.getDataSourceByType(c.QRADAR).get.route,n)).then(i=>i.data)});if(r.isError)return e.jsx(T,{error:r.error});if(r.isPending)return e.jsx(E,{});if(r.data)return e.jsxs(f,{children:[e.jsx(C,{children:"Update AQRadar Data Source"}),e.jsxs(l,{className:"lg:max-w-3xl",children:[e.jsx(me,{}),e.jsx(Oe,{id:n,values:r.data,successCallback:a,cancelCallback:s})]})]})}function pe({handleSubmit:n,itemId:a}){const[s,r]=D.useState(""),i=p({mutationFn:async t=>d.post(h.getDataSourceByType(c.VMWARE_VCENTER).validate.route,t).then(()=>r("Success")),onError:t=>r(W(t).message)});return e.jsx(R,{onClick:n(t=>i.mutate({config:t,item_id:a})),isPending:i.isPending,isSuccess:i.isSuccess,result:s})}function xe(){return e.jsxs(l,{children:[e.jsx(Y,{children:e.jsx(M,{})}),e.jsxs(U,{title:"Prepare credentials",children:[e.jsx(g,{children:"Log in to vCenter and create a new user (Read-Only permissions)"}),e.jsx(g,{children:"Create a new credential profile and add username and password fields"})]})]})}const je={formFieldParams:{token:{visible:!1},domain:{visible:!1}}};function $e({successCallback:n,cancelCallback:a}){var i;const s=j({defaultValues:{is_enabled:!0,is_asset_collection_enabled:!0,asset_collection_interval:5,priority:4}}),r=p({mutationFn:t=>d.post(h.getDataSourceByType(c.VMWARE_VCENTER).create.route,t),onSuccess:()=>n(),onError:t=>s.setError(...S(t))});return e.jsxs(f,{children:[e.jsx(C,{children:"Create VMware vCenter Data Source"}),e.jsxs(l,{className:"lg:max-w-3xl",children:[e.jsx(xe,{}),e.jsxs(_,{onSubmit:s.handleSubmit(t=>r.mutate(t)),children:[e.jsx(w,{methods:s,formFieldParams:{host:{placeholder:"https://vcenter.corp.com"}},credentialFormConfig:je}),e.jsx(b,{methods:s}),e.jsx(pe,{handleSubmit:s.handleSubmit}),e.jsx(y,{children:(i=s.formState.errors.root)==null?void 0:i.message}),e.jsx(I,{cancelBtnName:"Discard",submitBtnName:"Create",onCancel:a,isPending:r.isPending})]})]})]})}function ze({id:n,values:a,successCallback:s,cancelCallback:r,className:i}){var m;const t=j({defaultValues:a}),u=p({mutationFn:o=>d.put(x(h.getDataSourceByType(c.VMWARE_VCENTER).update.route,n),o),onSuccess:()=>s(),onError:o=>t.setError(...S(o))});return e.jsxs(_,{className:i,onSubmit:t.handleSubmit(o=>u.mutate(o)),children:[e.jsx(w,{methods:t,formFieldParams:{host:{placeholder:"https://vcenter.corp.com"}},credentialFormConfig:je}),e.jsx(A,{methods:t}),e.jsx(b,{methods:t}),e.jsx(pe,{handleSubmit:t.handleSubmit,itemId:n}),e.jsx(y,{children:(m=t.formState.errors.root)==null?void 0:m.message}),e.jsx(I,{cancelBtnName:"Cancel",submitBtnName:"Save Changes",onCancel:r,isPending:u.isPending})]})}function He({id:n,successCallback:a,cancelCallback:s}){const r=F({queryKey:["data_sources",n],queryFn:()=>d.get(x(h.getDataSourceByType(c.VMWARE_VCENTER).get.route,n)).then(i=>i.data)});if(r.isError)return e.jsx(T,{error:r.error});if(r.isPending)return e.jsx(E,{});if(r.data)return e.jsxs(f,{children:[e.jsx(C,{children:"Update VMware vCenter Data Source"}),e.jsxs(l,{className:"lg:max-w-3xl",children:[e.jsx(xe,{}),e.jsx(ze,{id:n,values:r.data,successCallback:a,cancelCallback:s})]})]})}const N="h-10 w-10";function v(n,a,s){return{get:{route:n,component:void 0},delete:{route:n,component:void 0},create:{route:n,component:a},update:{route:n,component:s},validate:{component:void 0,route:x(n,"validate")}}}const H=[{id:c.ARIA_LOGS,name:"VMware Aria Operations for Logs",description:"Provides unified visibility across IT environments through robust log aggregation, analytics, and faster root cause determination",type:"Log Management",vendor:"VMware",...v("/api/data_sources/aria_logs",Ve,Fe),icon:e.jsx(V,{className:N,src:Re})},{id:c.ARIA_NETWORKS,name:"VMware Aria Operations for Networks",description:"Network monitoring and troubleshooting tool that helps you build an optimized, highly available and secure network infrastructure across your VMware Cloud Foundation and NSX environments",type:"Log Management",vendor:"VMware",...v("/api/data_sources/aria_networks",Te,De),icon:e.jsx(V,{className:N,src:We})},{id:c.IVANTI_ITSM,name:"Ivanti Neurons (HEAT) for ITSM",description:"Ivanti Neurons for ITSM is a IT service management platform that automates workflows, streamlines IT operations",type:"Service Management",vendor:"Ivanti",...v("/api/data_sources/ivanti_itsm",Le,qe),icon:e.jsx(V,{className:N,src:Ye})},{id:c.DEMO,name:"Demo",description:"Demo with sample data",type:"Log Management",vendor:"Armada",...v("/api/data_sources/demo",z,z),icon:"",isVisible:!1},{id:c.QRADAR,name:"IBM QRadar",description:"IBM QRadar is a network security management platform that provides situational awareness and compliance support. QRadar uses a combination of flow-based network knowledge, security event correlation, and asset-based vulnerability assessment.",type:"SIEM",vendor:"IBM",...v("/api/data_sources/qradar",Ke,Xe),icon:e.jsx(V,{className:N,src:Be})},{id:c.VMWARE_NSX,name:"VMware NSX-T",description:"VMware NSX is a network virtualization and security platform that enables a software-defined approach to networking that extends across data centers, clouds, and application frameworks",type:"Firewall",vendor:"VMware",...v("/api/data_sources/vmware_nsx",Pe,Qe),icon:e.jsx(V,{className:N,src:Me})},{id:c.VMWARE_VCENTER,name:"VMware vCenter (vSphere)",description:"vCenter Server Appliance is the centralized management utility for VMware, and is used to manage virtual machines, multiple ESXi hosts, and all dependent components from a single centralized location",type:"Infra Management",vendor:"VMware",...v("/api/data_sources/vmware_vcenter",$e,He),icon:e.jsx(V,{className:N,src:ke})}],h={getDataSourceByType(n){return H.find(a=>a.id===n)},getAllDataSources(){return H}};export{h as d};
