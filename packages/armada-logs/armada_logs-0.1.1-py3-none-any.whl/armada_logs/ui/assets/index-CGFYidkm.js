import{E as g,g as y,t as d,F as m,G as f,x as h,r as c,y as D,j as e,z as w,M as C,A as F,D as k,H as E,I as N,b as S,ap as T,q as A,u as B,J as V,B as M,l as _,m as L,n as O,k as q,p as v,T as H,C as I,s as P,N as G,L as J,U as z,v as K}from"./index-Be3uPtkT.js";import{d as j}from"./supportedDataSources-D93vqAlP.js";import"./index-ZAiMN538.js";import"./create-CqKbYF33.js";function Q({id:a,type:t,onSuccess:s}){return{deleteSource:g({mutationFn:()=>{const o=j.getDataSourceByType(t);if(!o)throw new Error(`Invalid data source type - ${o}`);return y.delete(d(o.delete.route,a))},onSuccess:()=>s?s():m.success("The Data Source was deleted"),onError:o=>m.error(f(o).message)}).mutate}}const b=[];Object.entries(j.getAllDataSources()).forEach(([a,t])=>{!t.create.component||!t.create.route||t.isVisible==!1||b.push({name:t.name,description:t.description,icon:t.icon,route:t.create.route,type:t.type,vendor:t.vendor,id:t.id})});function R(){const{isOpen:a,open:t,close:s}=h(),[n,o]=c.useState(null),l=D(),u=c.useCallback(()=>{o(null),s()},[s]);return c.useEffect(()=>{n&&l(d(n.id,"create"))},[n,l]),e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"btn-primary",onClick:t,children:"Add New"}),e.jsxs(C,{isOpen:a,close:u,className:"max-w-4xl h-[40rem]",children:[e.jsx(F,{children:"Select Data Source Type"}),e.jsx(k,{items:b,isSearchBarVisible:!0,itemContainerClassName:"overflow-y-scroll pe-1 h-[30rem]",filter:[{name:"Type",value:"type"},{name:"Vendor",value:"vendor"}],onSelected:o})]})]})}function U({id:a,type:t}){const s=h(),{deleteSource:n}=Q({id:a,type:t});return e.jsxs(e.Fragment,{children:[e.jsx(E,{onClick:()=>s.setOpen(!0)}),e.jsx(N,{isOpen:s.isOpen,close:s.close,message:"Are you sure you want to delete this entry?",action:()=>n()})]})}const x=[{key:"all",title:"All"},{key:"disabled",title:"Disabled"},{key:"enabled",title:"Enabled"}];function $({onGlobalFilterUpdate:a,onColumnFilterUpdate:t}){const[s,n]=c.useState([x[0].key]),o=c.useCallback(l=>(n(l),l[0]==="enabled"?t([{id:"is_enabled",value:!0}]):l[0]==="disabled"?t([{id:"is_enabled",value:!1}]):t([])),[n,t]);return e.jsxs(S,{className:"flex gap-4 mb-4",children:[e.jsx(T,{value:s,options:x,prefix:"Status",onChange:o,dropdownClassName:"min-w-56"}),e.jsx(A,{className:"grow",onSearch:l=>a(l)})]})}function W({cell:a}){return e.jsx(G,{className:"link link-primary",to:d(a.row.getValue("entity_type"),a.row.getValue("id")),children:a.getValue()})}function X({cell:a}){const t=a.row.getValue("id"),s=a.row.getValue("entity_type");return e.jsxs(S,{className:"flex gap-2",children:[e.jsx(J,{to:d(s,t,"update"),children:e.jsx(z,{})}),e.jsx(U,{type:s,id:t})]})}function ae(){const a=B({queryKey:["datasources"],queryFn:()=>y.get("/api/data_sources").then(r=>r.data)}),[t,s]=c.useState(""),[n,o]=c.useState([]),l=c.useMemo(()=>{const r=K();return[r.accessor("name",{header:"Name",cell:({cell:i})=>e.jsx(W,{cell:i})}),r.accessor("host",{header:"Host"}),r.accessor("description",{header:"Description"}),r.accessor("entity_type",{header:"Type"}),r.accessor(i=>{var p;return(p=i.credential_profile)==null?void 0:p.name},{header:"Credential Profile"}),r.accessor("is_enabled",{header:"Enabled",filterFn:"weakEquals",cell:i=>e.jsx(V,{value:i.getValue()})}),r.accessor("id",{header:"Actions",enableGlobalFilter:!1,cell:({cell:i})=>e.jsx(X,{cell:i})})]},[]),u=c.useMemo(()=>({data:a.data??[],columns:l,globalFilterFn:"includesString",state:{globalFilter:t,columnFilters:n},enablePagination:!0}),[l,a.data,t,n]);return e.jsxs(M,{children:[e.jsxs(_,{className:"mb-6",children:[e.jsx(L,{description:"View and manage your connected data sources",children:"Data Sources"}),e.jsx(O,{children:e.jsx(R,{})})]}),e.jsx($,{onGlobalFilterUpdate:r=>s(r),onColumnFilterUpdate:r=>o(r)}),e.jsx(q,{className:"grow",children:e.jsxs(v,{children:[a.isSuccess&&e.jsx(H,{...u}),a.isPending&&e.jsx(I,{}),a.isError&&e.jsx(P,{error:a.error})]})})]})}export{ae as default};
