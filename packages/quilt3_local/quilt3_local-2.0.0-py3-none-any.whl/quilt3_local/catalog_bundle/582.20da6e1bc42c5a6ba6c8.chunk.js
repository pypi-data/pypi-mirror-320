"use strict";(self.webpackChunkquilt_navigator=self.webpackChunkquilt_navigator||[]).push([[582],{62828:(e,n,a)=>{a.d(n,{E:()=>f,Z:()=>b});var t=a(70655),i=a(94184),r=a.n(i),l=a(87553),o=a(67294),c=a(41120),u=a(22318),s=a(92863),m=a(23307),d=a(99643),k=a(42059),v=c.Z((function(e){return{root:{alignItems:"center",display:"inline-flex"},icon:{color:e.palette.text.hint,fontSize:16,marginRight:"2px"}}}));function p(e){var n=e.className,a=e.children,i=(0,t._T)(e,["className","children"]),l=v();return o.createElement(u.Z,(0,t.pi)({className:r()(l.root,n),component:"span",variant:"body2"},i),a)}function h(e){var n=e.className,a=g();return o.createElement("div",{className:r()(a.root,n)},o.createElement(m.Z,{animate:!0,className:a.property,width:"80px",height:"14px"}),o.createElement(m.Z,{animate:!0,className:a.property,width:"80px",height:"14px"}))}var g=c.Z((function(e){return{root:{alignItems:"center",display:"flex"},property:{marginLeft:e.spacing(1)}}}));function f(e){var n=e.className,a=e.lastModified,t=e.size,i=g(),c=o.useMemo((function(){return new Date}),[]),u=o.useMemo((function(){return a?l.Z(a,c.getFullYear()===a.getFullYear()?"d MMM":"d MMM yyyy"):null}),[a,c]),s=o.useMemo((function(){return(0,d.kR)(t)}),[t]);return o.createElement("div",{className:r()(i.root,n)},u&&o.createElement(p,{title:null==a?void 0:a.toLocaleString(),className:i.property},u),o.createElement(p,{className:i.property},s))}function b(e){var n=e.className,a=e.data,i=g();return o.createElement("div",{className:r()(i.root,n)},a.case({Ok:k.NB.case({Exists:function(e){var a=e.lastModified,i=e.size;return o.createElement(f,(0,t.pi)({},{className:n,lastModified:a,size:i}))},_:function(){return null}}),Err:function(e){return o.createElement(s.Z,{title:"Fetching object info failed: ".concat(e.message),color:"error"},"warning_outline")},_:function(){return o.createElement(h,{className:n})}}))}},54208:(e,n,a)=>{a.d(n,{Z:()=>c});var t=a(67294),i=a(17812),r=a(92863),l=a(38396),o=a(85639);function c(e){var n=e.className,a=e.items,c=t.useState(null),u=c[0],s=c[1],m=t.useCallback((function(e){return s(e.target)}),[s]),d=t.useCallback((function(){return s(null)}),[s]),k=t.useCallback((function(e){return function(){e(),s(null)}}),[]);return t.createElement(t.Fragment,null,t.createElement(i.Z,{className:n,onClick:m,size:"small"},t.createElement(r.Z,null,"more_vert")),t.createElement(l.Z,{anchorEl:u,open:!!u,onClose:d},a.map((function(e){var n=e.onClick,a=e.title;return t.createElement(o.Z,{key:a,onClick:k(n)},a)}))))}},87832:(e,n,a)=>{a.d(n,{WZ:()=>u.WZ,Ss:()=>t.Z,HI:()=>i.Z,wx:()=>r.Z,RZ:()=>u.RZ,fc:()=>o.f,BA:()=>s.BA,rr:()=>u.rr,Nt:()=>u.Nt,ux:()=>u.ux,RY:()=>m.Z,H4:()=>s.H4,Wr:()=>u.Wr,bF:()=>s.bF,cD:()=>u.cD,rV:()=>p,px:()=>l.p,OW:()=>u.OW,Wk:()=>u.Wk,eh:()=>c.e,qi:()=>u.qi});var t=a(55812),i=a(11988),r=a(52247),l=(a(78188),a(20913),a(94070)),o=a(5308),c=a(20358),u=a(23993),s=a(82786),m=a(85374),d=(a(41306),a(67294)),k=a(5977),v={revisePackage:!0};function p(){var e=k.k6(),n=k.TH(),a=d.useMemo((function(){return new URLSearchParams(n.search)}),[n.search]),t=a.getAll("action"),i=d.useRef(function(e){return e.every((function(e){return!!v[e]}))}(t)?t:[]);return d.useEffect((function(){a.has("action")&&function(e,n){e.delete("action"),n.replace({search:e.toString()})}(a,e)}),[e,a]),i.current}},30582:(e,n,a)=>{a.r(n),a.d(n,{default:()=>wn});var t=a(70655),i=a(26470),r=a(66518),l=a.n(r),o=a(67826),c=a(13646),u=a(13462),s=a(18549),m=a(36962),d=a(67294),k=a(5977),v=a(73727),p=a(92432),h=a(41120),g=a(10529),f=a(95477),b=a(22318),E=a(282),y=a(17812),N=a(92863),w=a(66869),Z=a(78869),S=a(15805),D=a(20740),F=a(24452),C=a(33261),T=a(52663),P=a(66083),V=a(29525),x=a(66856),O=a(60409),_=a(766),M=a(55743);var A=a(99643);function q(e){var n,a=this,i=e.onClose,r=e.onConfirm,l=e.open,o=e.size,c=d.useState(null),u=c[0],s=c[1],m=d.useState(!1),k=m[0],v=m[1],p=d.useCallback((function(){return(0,t.mG)(a,void 0,void 0,(function(){var e;return(0,t.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),v(!0),[4,r()];case 1:return n.sent(),v(!1),i(),[3,3];case 2:return(e=n.sent())instanceof Error&&s(e),[3,3];case 3:return[2]}}))}))}),[i,r]);return d.createElement(T.Z,{open:l,onClose:i},d.createElement(P.Z,null,"Open in Teleport"),d.createElement(V.Z,null,d.createElement(b.Z,null,"Download package and open in desktop application"),"number"==typeof(n=o)&&!Number.isNaN(n)&&d.createElement(b.Z,null,"Total size of package is ",(0,A.kR)(o)),d.createElement(b.Z,null,"It could take a while"),u&&d.createElement(w.Z,{severity:"error"},u.message)),d.createElement(x.Z,null,d.createElement(E.Z,{onClick:i},"Cancel"),d.createElement(E.Z,{color:"primary",disabled:k,onClick:p,variant:"contained"},"Confirm")))}var R=function(e,n){var a=this,i=_.D$().desktop,r=O.D$(),l=d.useState(!1),o=l[0],c=l[1],u=d.useCallback((function(){return(0,t.mG)(a,void 0,void 0,(function(){var n;return(0,t.Jh)(this,(function(a){switch(a.label){case 0:return i?[4,r.invoke(O.FP.uh,e)]:[3,2];case 1:return a.sent(),[3,3];case 2:n=function(e){return M.Pz(e).replace("quilt+s3","teleport")}(e),window.location.assign(n),a.label=3;case 3:return[2]}}))}))}),[i,r,e]),s=d.useCallback((function(){return c(!1)}),[]);return{confirm:d.useCallback((function(){!n||n>104857600?c(!0):u()}),[u,n]),confirming:o,openInDesktop:u,unconfirm:s}},z=a(43987),I=a(85693),B=a(13950),W=a(84268),L=a(27474),U=a(57156),$=a(69534),j=a(23915),H=a(82268),G=a(36473),J=a(34314),Y=a(62799),K=a(15592),Q=a(37791),X=a(62828),ee=a(37600),ne=a(25170),ae=a(66688),te=a(98187),ie=a(70397),re=a(30757),le=a(20666),oe=a(31708),ce=a(39795),ue=a(87832),se=a(62782),me=a(47426),de=a(38599),ke={kind:"Document",definitions:(0,t.ev)((0,t.ev)((0,t.ev)([{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"containers_Bucket_PackageDialog_gql_PackagePromote"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"params"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PackagePushParams"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"src"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PackagePromoteSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"packagePromote"},arguments:[{kind:"Argument",name:{kind:"Name",value:"params"},value:{kind:"Variable",name:{kind:"Name",value:"params"}}},{kind:"Argument",name:{kind:"Name",value:"src"},value:{kind:"Variable",name:{kind:"Name",value:"src"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"PackagePushSuccessSelection"}},{kind:"FragmentSpread",name:{kind:"Name",value:"InvalidInputSelection"}},{kind:"FragmentSpread",name:{kind:"Name",value:"OperationErrorSelection"}}]}}]}}],se.k.definitions,!0),me.t.definitions,!0),de.A.definitions,!0)},ve=a(42059),pe=h.Z((function(e){return{meta:{marginTop:e.spacing(3)}}}));function he(e){var n=e.animate,a=pe();return d.createElement(d.Fragment,null,d.createElement(ue.H4,{animate:n}),d.createElement(ue.H4,{animate:n}),d.createElement(ue.BA,{className:a.meta,animate:n}),d.createElement(ue.bF,{animate:n}))}function ge(e){var n=e.bucket,a=$.D$().urls;return d.createElement(P.Z,null,"Push package to"," ",d.createElement(ie.Z,{target:"_blank",to:a.bucketOverview(n)},n)," ","bucket")}var fe=h.Z((function(e){return{form:{display:"flex",flexDirection:"column",height:"100%",overflowY:"auto"},meta:{display:"flex",flexDirection:"column",paddingTop:e.spacing(3),overflowY:"auto"}}}));function be(e){var n=this,a=e.bucket,i=e.close,r=e.hash,l=e.initialMeta,o=e.name,u=e.responseError,s=e.schema,m=e.schemaLoading,k=e.selectedWorkflow,v=e.setSubmitting,h=e.setSuccess,f=e.setWorkflow,y=e.successor,w=e.validate,Z=e.workflowsConfig,S=ue.Wk(k),D=ue.OW(y.slug),F=d.useState(""),C=F[0],T=F[1],P=d.useState(0),O=P[0],_=P[1],M=fe(),A=ue.qi(Z),q=p.Db(ke)[1],R=function(e){var i=e.commitMessage,l=e.name,c=e.meta,u=e.workflow;return(0,t.mG)(n,void 0,void 0,(function(){var e,n,m,d;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,q({params:{bucket:y.slug,name:l,message:i,userMeta:null!==(d=ve.au(c,s))&&void 0!==d?d:null,workflow:u.slug===ce.h8?null:u.slug===ce.xW?"":u.slug},src:{bucket:a,name:o,hash:r}})];case 1:if((e=t.sent()).error)throw e.error;if(!e.data)throw new Error("No data returned by the API");switch((n=e.data.packagePromote).__typename){case"PackagePushSuccess":return h({name:l,hash:n.revision.hash,bucket:y.slug}),[2];case"OperationError":return[2,(0,re.D)(n.message)];case"InvalidInput":return[2,(0,re.k)(n.errors)];default:(0,j.Z)(n)}return[3,3];case 2:return m=t.sent(),console.error("Error creating manifest:"),console.error(m),[2,(0,re.D)(m.message?"Unexpected error: ".concat(m.message):ue.RZ.MANIFEST)];case 3:return[2]}}))}))},z=d.useCallback((function(e){return(0,t.mG)(n,void 0,void 0,(function(){var n,a;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return[4,D.validate(e)];case 1:return n=t.sent(),(a=d.createElement(ue.Nt,{exists:!!n}))!==C&&T(a),[2]}}))}))}),[C,D]),I=d.useState(null),B=I[0],W=I[1],L=d.useMemo((function(){return new window.ResizeObserver((function(e){var n=e[0].contentRect.height;_(n)}))}),[_]),U=d.useState(!1),$=U[0],H=U[1],G=d.useCallback((function(e){var a=e.modified,i=e.values;return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){return a.workflow&&i.workflow!==k&&(f(i.workflow),H(!0),setTimeout((function(){H(!1)}),300)),z(i.name),[2]}))}))}),[z,k,f]);d.useEffect((function(){return B&&L.observe(B),function(){B&&L.unobserve(B)}}),[B,L]);var J=ue.cD({metaHeight:O});return d.createElement(ae.l0,{onSubmit:function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){switch(n.label){case 0:v(!0),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,R.apply(void 0,e)];case 2:return[2,n.sent()];case 3:return v(!1),[7];case 4:return[2]}}))}))},subscription:{error:!0,hasValidationErrors:!0,submitError:!0,submitFailed:!0,submitting:!0}},(function(e){var n=e.error,t=e.hasValidationErrors,r=e.submitError,v=e.submitFailed,p=e.submitting,h=e.handleSubmit;return d.createElement(d.Fragment,null,d.createElement(ge,{bucket:y.slug}),d.createElement(V.Z,{classes:J},d.createElement("form",{onSubmit:h,className:M.form},d.createElement(ae.lP,{subscription:{modified:!0,values:!0},onChange:G}),d.createElement(ae.lP,{subscription:{modified:!0,values:!0},onChange:function(e){var n=e.modified,a=e.values;(null==n?void 0:n.workflow)&&f(a.workflow)}}),d.createElement(ae.gN,{component:ue.Wr,bucket:a,name:"workflow",workflowsConfig:Z,initialValue:k,validate:A,validateFields:["meta","workflow"],errors:{required:"Workflow is required for this bucket."}}),d.createElement(ae.gN,{component:ue.rr,name:"name",workflow:k||Z,validate:oe.ne(oe.C1,S.validate),validateFields:["name"],errors:{required:"Enter a package name",invalid:"Invalid package name",pattern:"Name should match ".concat(null==k?void 0:k.packageNamePattern)},helperText:C,initialValue:o}),d.createElement(ae.gN,{component:ue.WZ,name:"commitMessage",validate:oe.C1,validateFields:["commitMessage"],errors:{required:"Enter a commit message"}}),m||$?d.createElement(ue.BA,{className:M.meta,ref:W}):d.createElement(ae.gN,{className:M.meta,component:ue.fc,name:"meta",bucket:y.slug,schema:s,schemaError:u,validate:w,validateFields:["meta"],isEqual:c.Z,ref:W,initialValue:l}),d.createElement("input",{type:"submit",style:{display:"none"}}))),d.createElement(x.Z,null,p&&d.createElement(ue.RY,null,y.copyData?"Copying files and writing manifest":"Writing manifest"),!p&&(!!n||!!r)&&d.createElement(g.Z,{flexGrow:1,display:"flex",alignItems:"center",pl:2},d.createElement(N.Z,{color:"error"},"error_outline"),d.createElement(g.Z,{pl:1}),d.createElement(b.Z,{variant:"body2",color:"error"},n||r)),d.createElement(E.Z,{onClick:i,disabled:p},"Cancel"),d.createElement(E.Z,{onClick:h,variant:"contained",color:"primary",disabled:p||v&&t},"Push")))}))}function Ee(e){var n=e.bucket,a=e.error,t=e.onCancel,i=$.D$().urls;return d.createElement(ue.Ss,{bucket:n,error:a,skeletonElement:d.createElement(he,{animate:!1}),title:d.createElement(d.Fragment,null,"Push package to"," ",d.createElement(ie.Z,{target:"_blank",to:i.bucketOverview(n)},n)," ","bucket"),onCancel:t})}function ye(e){var n=e.bucket,a=e.onCancel,t=$.D$().urls;return d.createElement(ue.HI,{skeletonElement:d.createElement(he,null),title:d.createElement(d.Fragment,null,"Push package to"," ",d.createElement(ie.Z,{target:"_blank",to:t.bucketOverview(n)},n)," ","bucket"),onCancel:a})}var Ne=le.U("app/containers/Bucket/PackageCopyDialog:DialogState",{Loading:function(){},Error:function(e){return e},Form:function(e){return e},Success:function(e){return e}});function we(e){var n=e.open,a=e.bucket,i=e.successor,r=e.name,l=e.hash,o=e.onExited,c=I.S3.use(),u=d.useState(null),s=u[0],m=u[1],k=d.useState(!1),v=k[0],p=k[1],h=d.useState(),g=h[0],f=h[1],b=ue.px({bucket:a,name:r,hash:l,skipEntries:!0,pause:!i||!n}),E=W.D$(ve.sq,{s3:c,bucket:i?i.slug:""},{noAutoFetch:!i||!n}),y=d.useMemo((function(){return s?Ne.Success(s):E.case({Ok:function(e){return b.case({Ok:function(n){return Ne.Form({manifest:n,workflowsConfig:e})},Err:Ne.Error,_:Ne.Loading})},Err:Ne.Error,_:Ne.Loading})}),[s,E,b]),N=d.useCallback((function(){v||(o({pushed:s}),m(null))}),[v,s,m,o]),w=d.useCallback((function(){v||(o({pushed:s}),m(null))}),[v,s,m,o]);return te.r3(n),d.createElement(T.Z,{fullWidth:!0,onClose:w,onExited:N,open:n,scroll:"body"},Ne.match({Error:function(e){return i&&d.createElement(Ee,{bucket:i.slug,onCancel:w,error:e})},Loading:function(){return i&&d.createElement(ye,{bucket:i.slug,onCancel:w})},Form:function(e){var n=e.manifest,o=e.workflowsConfig;return i&&d.createElement(ue.ux,{initialWorkflowId:n.workflowId,workflowsConfig:o,workflow:g},(function(e){return d.createElement(be,(0,t.pi)({},e,{bucket:a,close:w,setSubmitting:p,setSuccess:m,setWorkflow:f,workflowsConfig:o,initialMeta:n.meta,hash:l,name:r,successor:i}))}))},Success:function(e){return i&&d.createElement(ue.wx,(0,t.pi)({},e,{onClose:w}))}})(y))}var Ze=a(6709),Se=a(35992),De=a(29039),Fe=a(41973),Ce=a(73206),Te=a(9982),Pe=a(64395),Ve=h.Z({name:{wordBreak:"break-all"}});function xe(e){var n=e.bucket,a=e.name,t=Ve(),i=$.D$().urls,r=a.split("/"),l=r[0],o=r[1];return d.createElement("span",{className:t.name},d.createElement(ie.Z,{to:i.bucketPackageList(n,{filter:"".concat(l,"/")})},l,"/"),d.createElement(ie.Z,{to:i.bucketPackageDetail(n,a)},o))}var Oe=a(7212),_e=a(41810),Me=a(31733),Ae=h.Z((function(e){return{danger:{color:e.palette.error.dark},lock:{alignItems:"center",background:"rgba(255,255,255,0.7)",border:"1px solid ".concat(e.palette.action.disabled),borderRadius:e.shape.borderRadius,bottom:0,cursor:"not-allowed",display:"flex",flexDirection:"column",justifyContent:"center",left:0,position:"absolute",right:0,top:0},progressContainer:{display:"flex",position:"relative"}}}));function qe(e){var n=e.error,a=e.loading,t=e.onClose,i=e.onDelete,r=e.open,l=e.packageHandle,o=Ae(),c=d.useCallback((function(){i(l)}),[l,i]),u=d.useCallback((function(){a||t()}),[a,t]);return d.createElement(T.Z,{"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",open:r,onClose:u},d.createElement(P.Z,{id:"alert-dialog-title"},"Really delete revision"," ",d.createElement(_e.Z,null,Me.zL(l.hash))," of"," ",d.createElement(_e.Z,null,l.name),"?"),d.createElement(V.Z,{id:"alert-dialog-description"},d.createElement(Oe.Z,null,"This package revision will be lost forever. Package deletion does not delete objects in the package, but it does delete all metadata and all records of the contents of this revision. Are you sure you want to delete it?"),!!n&&d.createElement(w.Z,{severity:"error"},n)),d.createElement(x.Z,null,d.createElement(E.Z,{onClick:u,color:"primary",autoFocus:!0,disabled:a},"Cancel"),d.createElement(E.Z,{onClick:c,className:o.danger,disabled:a},"Yes, delete it")),a&&d.createElement("div",{className:o.lock},d.createElement("div",{className:o.progressContainer},d.createElement(f.Z,{size:80,variant:"indeterminate"}))))}var Re=a(94184),ze=a.n(Re),Ie=a(87553),Be=a(52387),We=a(62822),Le=a(50998),Ue=a(95757),$e=a(81860),je=a(46869),He=a(55517),Ge=a(67456),Je=a(9961),Ye=h.Z((function(e){return{revision:(0,t.pi)((0,t.pi)({},ie.R),{alignItems:"center",display:"inline-flex"}),mono:{fontFamily:e.typography.monospace.fontFamily},line:{whiteSpace:"nowrap"},secondaryText:{display:"block",height:40,overflow:"hidden",textOverflow:"ellipsis"},list:{width:420}}}));function Ke(e){var n=e.bucket,a=e.name,t=e.hash,i=e.hashOrTag,r=e.path,l=e.revisionListQuery,c=$.D$().urls,u=Ge.D$().push,s=Ye(),m=d.useRef(null),k=d.useState(null),p=k[0],h=k[1],E=d.useState(!1),w=E[0],Z=E[1],S=d.useCallback((function(){return Z(!0)}),[]),D=d.useCallback((function(){return Z(!1)}),[]),F=function(e){return"".concat(window.origin).concat(c.bucketPackageTree(n,a,e,r))},C=function(e,n){return function(a){a.preventDefault(),(0,Je.Z)(F(e),{container:(null==n?void 0:n.current)||void 0}),u("Canonical URI copied to clipboard")}};return d.createElement(d.Fragment,null,d.createElement("span",{className:s.revision,onClick:S,ref:h,title:i.length>10?i:void 0},o.Z(10,i)," ",d.createElement(N.Z,null,"expand_more")),!!t&&d.createElement(y.Z,{size:"small",title:"Copy package revision's canonical catalog URI to the clipboard",href:F(t),onClick:C(t),style:{marginTop:-4,marginBottom:-4}},d.createElement(N.Z,null,"link")),d.createElement(Be.ZP,{open:w&&!!p,anchorEl:p,onClose:D,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},d.createElement(We.Z,{className:s.list,ref:m},l.case({data:function(e){return e.package?e.package.revisions.page.map((function(e){return d.createElement(Le.Z,{key:"".concat(e.hash,":").concat(e.modified.valueOf()),button:!0,onClick:D,selected:e.hash===t,component:v.Link,to:c.bucketPackageTree(n,a,e.hash,r)},d.createElement(Ue.Z,{primary:Ie.Z(e.modified,"MMMM do yyyy - h:mma"),secondary:d.createElement("span",{className:s.secondaryText},d.createElement("span",{className:s.line},e.message||d.createElement("i",null,"No message")),d.createElement("br",null),d.createElement("span",{className:ze()(s.line,s.mono)},e.hash))}),d.createElement($e.Z,null,d.createElement(y.Z,{title:"Copy package revision's canonical catalog URI to the clipboard",href:F(e.hash),onClick:C(e.hash,m)},d.createElement(N.Z,null,"link"))))})):d.createElement(Le.Z,null,d.createElement(Ue.Z,{primary:"No revisions found",secondary:"Looks like this package has been deleted"}))},error:function(){return d.createElement(Le.Z,null,d.createElement(je.Z,null,d.createElement(N.Z,null,"error")),d.createElement(b.Z,{variant:"body1"},"Error fetching revisions"))},fetching:function(){return d.createElement(Le.Z,null,d.createElement(je.Z,null,d.createElement(f.Z,{size:24})),d.createElement(b.Z,{variant:"body1"},"Fetching revisions"))}}),d.createElement(He.Z,null),d.createElement(Le.Z,{button:!0,onClick:D,component:v.Link,to:c.bucketPackageRevisions(n,a)},d.createElement(g.Z,{textAlign:"center",width:"100%"},"Show all revisions")))))}var Qe=a(54208);function Xe(e){var n=e.className,a=e.onCreateFile,t=e.onDelete,i=e.onDesktop,r=B.D$(),l=_.D$().desktop,o=d.useMemo((function(){var e,n,o,c,u,s,m=[];return(null===(n=null===(e=null==r?void 0:r.ui)||void 0===e?void 0:e.actions)||void 0===n?void 0:n.revisePackage)&&m.push({onClick:a,title:"Create file"}),(null===(c=null===(o=null==r?void 0:r.ui)||void 0===o?void 0:o.actions)||void 0===c?void 0:c.deleteRevision)&&m.push({onClick:t,title:"Delete revision"}),(null===(s=null===(u=null==r?void 0:r.ui)||void 0===u?void 0:u.actions)||void 0===s?void 0:s.openInDesktop)&&!l&&m.push({onClick:i,title:"Open in Teleport"}),m}),[l,a,t,i,r]);return o.length?d.createElement(Qe.Z,{className:n,items:o}):null}var en={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"containers_Bucket_PackageTree_gql_Revision"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bucket"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hashOrTag"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"package"},arguments:[{kind:"Argument",name:{kind:"Name",value:"bucket"},value:{kind:"Variable",name:{kind:"Name",value:"bucket"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bucket"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"revision"},arguments:[{kind:"Argument",name:{kind:"Name",value:"hashOrTag"},value:{kind:"Variable",name:{kind:"Name",value:"hashOrTag"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hash"}},{kind:"Field",name:{kind:"Name",value:"totalBytes"}}]}}]}}]}}]},nn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"containers_Bucket_PackageTree_gql_RevisionList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bucket"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"package"},arguments:[{kind:"Argument",name:{kind:"Name",value:"bucket"},value:{kind:"Variable",name:{kind:"Name",value:"bucket"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bucket"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"revisions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"page"},arguments:[{kind:"Argument",name:{kind:"Name",value:"number"},value:{kind:"IntValue",value:"1"}},{kind:"Argument",name:{kind:"Name",value:"perPage"},value:{kind:"IntValue",value:"5"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hash"}},{kind:"Field",name:{kind:"Name",value:"modified"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}}]}}]},an={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"containers_Bucket_PackageTree_gql_Dir"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bucket"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hash"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"path"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"package"},arguments:[{kind:"Argument",name:{kind:"Name",value:"bucket"},value:{kind:"Variable",name:{kind:"Name",value:"bucket"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bucket"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"revision"},arguments:[{kind:"Argument",name:{kind:"Name",value:"hashOrTag"},value:{kind:"Variable",name:{kind:"Name",value:"hash"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hash"}},{kind:"Field",name:{kind:"Name",value:"dir"},arguments:[{kind:"Argument",name:{kind:"Name",value:"path"},value:{kind:"Variable",name:{kind:"Name",value:"path"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"path"}},{kind:"Field",name:{kind:"Name",value:"metadata"}},{kind:"Field",name:{kind:"Name",value:"children"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PackageFile"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"path"}},{kind:"Field",name:{kind:"Name",value:"size"}},{kind:"Field",name:{kind:"Name",value:"physicalKey"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PackageDir"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"path"}},{kind:"Field",name:{kind:"Name",value:"size"}}]}}]}}]}}]}}]}}]}}]},tn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"containers_Bucket_PackageTree_gql_File"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bucket"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hash"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"path"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"package"},arguments:[{kind:"Argument",name:{kind:"Name",value:"bucket"},value:{kind:"Variable",name:{kind:"Name",value:"bucket"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bucket"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"revision"},arguments:[{kind:"Argument",name:{kind:"Name",value:"hashOrTag"},value:{kind:"Variable",name:{kind:"Name",value:"hash"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hash"}},{kind:"Field",name:{kind:"Name",value:"file"},arguments:[{kind:"Argument",name:{kind:"Name",value:"path"},value:{kind:"Variable",name:{kind:"Name",value:"path"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"path"}},{kind:"Field",name:{kind:"Name",value:"metadata"}},{kind:"Field",name:{kind:"Name",value:"size"}},{kind:"Field",name:{kind:"Name",value:"physicalKey"}}]}}]}}]}}]}}]},rn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"containers_Bucket_PackageTree_gql_DeleteRevision"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bucket"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hash"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"packageRevisionDelete"},arguments:[{kind:"Argument",name:{kind:"Name",value:"bucket"},value:{kind:"Variable",name:{kind:"Name",value:"bucket"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"hash"},value:{kind:"Variable",name:{kind:"Name",value:"hash"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OperationError"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}}]};function ln(e){var n=e.bucket,a=e.name,i=e.hash,r=e.hashOrTag,c=e.path,u=c&&' --path "'.concat(G.ge(c),'"'),s=c&&', path="'.concat(G.ge(c),'"'),m="latest"===r?"":o.Z(10,i),k=m&&', top_hash="'.concat(m,'"'),v=m&&" --top-hash ".concat(m),p=[{label:"Python",hl:"python",contents:l()(gn||(gn=(0,t.cy)(['\n        import quilt3 as q3\n        # Browse\n        p = q3.Package.browse("','"',', registry="s3://','")\n        # make changes to package adding individual files\n        p.set("data.csv", "data.csv")\n        # or whole directories\n        p.set_dir("subdir", "subdir")\n        # and push changes\n        q3.Package.push("','", registry="s3://','", message="Hello World")\n\n        # Download (be mindful of large packages)\n        q3.Package.install("','"',"",', registry="s3://','", dest=".")\n      '],['\n        import quilt3 as q3\n        # Browse\n        p = q3.Package.browse("','"',', registry="s3://','")\n        # make changes to package adding individual files\n        p.set("data.csv", "data.csv")\n        # or whole directories\n        p.set_dir("subdir", "subdir")\n        # and push changes\n        q3.Package.push("','", registry="s3://','", message="Hello World")\n\n        # Download (be mindful of large packages)\n        q3.Package.install("','"',"",', registry="s3://','", dest=".")\n      '])),a,k,n,a,n,a,s,k,n)},{label:"CLI",hl:"bash",contents:l()(fn||(fn=(0,t.cy)(['\n          # Download package\n          quilt3 install "','"',""," --registry s3://"," --dest .\n        "],['\n          # Download package\n          quilt3 install "','"',""," --registry s3://"," --dest .\n        "])),a,u,v,n)+(c?"":l()(bn||(bn=(0,t.cy)(['\n\n              # Upload package\n              echo "Hello World" > README.md\n              quilt3 push "','" --registry s3://'," --dir .\n            "],['\\n\n              # Upload package\n              echo "Hello World" > README.md\n              quilt3 push "','" --registry s3://'," --dir .\n            "])),a,n))},{label:"URI",contents:M.Pz({bucket:n,name:a,hash:i,path:c})}];return d.createElement(K.Z,null,p)}var on=h.Z((function(e){var n;return{topBar:{alignItems:"flex-end",display:"flex",marginBottom:e.spacing(2),marginTop:e.spacing(.5)},crumbs:(0,t.pi)((0,t.pi)({},e.typography.body1),(n={maxWidth:"calc(100% - 160px)",overflowWrap:"break-word"},n[e.breakpoints.down("xs")]={maxWidth:"calc(100% - 40px)"},n)),spacer:{flexGrow:1}}}));function cn(e){var n=e.crumbs,a=e.children,t=on();return d.createElement("div",{className:t.topBar},d.createElement("div",{className:t.crumbs,onCopy:Z.Yn},(0,Z.sY)(n)),d.createElement("div",{className:t.spacer}),a)}var un=h.Z((function(e){return{button:{flexShrink:0,marginBottom:"-3px",marginLeft:e.spacing(1),marginTop:"-3px"}}}));function sn(e){var n=this,a=e.bucket,r=e.name,l=e.hash,o=e.hashOrTag,m=e.path,v=e.crumbs,h=e.size,y=ue.rV(),N=k.k6(),w=$.D$().urls,Z=un(),D=(0,Y.aM)({query:an,variables:{bucket:a,name:r,hash:l,path:G.ge(m)}}),F=d.useCallback((function(e){return w.bucketPackageTree(a,r,o,e.logicalKey)}),[w,a,r,o]),C=d.useState(y.includes("revisePackage"))[0],T=ue.eh({initialOpen:C,bucket:a,src:{name:r,hash:l}}),P=d.useState(null),V=P[0],x=P[1],O=d.useCallback((function(){x(null)}),[x]);(0,J.Z)({bucket:a,name:r,hashOrTag:o},(function(e){c.Z({bucket:a,name:r,hashOrTag:o},e)||T.close()}));var _=B.D$(),M=d.useCallback((function(){N.push(w.bucketPackageList(a))}),[a,N,w]),A=d.useState({error:void 0,loading:!1,opened:!1}),I=A[0],W=A[1],L=d.useCallback((function(){return W(u.Z("opened",!0))}),[]),U=d.useCallback((function(){W(s.Z({error:void 0,opened:!1}))}),[]),H=p.Db(rn)[1],K=d.useCallback((function(){return(0,t.mG)(n,void 0,void 0,(function(){var e,n,i,o;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:W(u.Z("loading",!0)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,H({bucket:a,name:r,hash:l})];case 2:if((e=t.sent()).error)throw e.error;if(!e.data)throw new Error("No data returned by the API");switch((n=e.data.packageRevisionDelete).__typename){case"PackageRevisionDeleteSuccess":return W(s.Z({opened:!1,loading:!1})),M(),[2];case"OperationError":return W(s.Z({error:n.message,loading:!1})),[2];default:(0,j.Z)(n)}return[3,4];case 3:return i=t.sent(),o="Unexpected error",i.message&&(o="".concat(o,": ").concat(i.message)),W(s.Z({error:o,loading:!1})),[3,4];case 4:return[2]}}))}))}),[a,l,r,H,M,W]),X=d.useMemo((function(){return{bucket:a,name:r,hash:l}}),[a,r,l]),ae=R(X,h),te=S.BF(X,m);return d.createElement(d.Fragment,null,d.createElement(q,{open:ae.confirming,onClose:ae.unconfirm,onConfirm:ae.openInDesktop,size:h}),d.createElement(we,{bucket:a,hash:l,name:r,open:!!V,successor:V,onExited:O}),d.createElement(qe,{error:I.error,open:I.opened,packageHandle:X,onClose:U,loading:I.loading,onDelete:K}),T.render({resetFiles:"Undo changes",submit:"Push",successBrowse:"Browse",successTitle:"Push complete",successRenderMessage:function(e){var n=e.packageLink;return d.createElement(d.Fragment,null,"Package revision ",n," successfully created")},title:"Push package revision"}),D.case({fetching:function(){return d.createElement(d.Fragment,null,d.createElement(cn,{crumbs:v}),d.createElement(g.Z,{mt:2},d.createElement(f.Z,null)))},data:function(e){var n,c,u,s,k,p,h,f,y,N,S,D,C=null===(c=null===(n=e.package)||void 0===n?void 0:n.revision)||void 0===c?void 0:c.dir;if(!C)return d.createElement(d.Fragment,null,d.createElement(cn,{crumbs:v}),d.createElement(g.Z,{mt:4},d.createElement(b.Z,{variant:"h4",align:"center",gutterBottom:!0},"Error loading directory"),d.createElement(b.Z,{variant:"body1",align:"center"},"Seems like there's no such directory in this package")));var P=C.children.map((function(e){switch(e.__typename){case"PackageFile":return{type:"file",name:(0,i.basename)(e.path),to:w.bucketPackageTree(a,r,o,e.path),size:e.size};case"PackageDir":return{type:"dir",name:(0,i.basename)(e.path),to:w.bucketPackageTree(a,r,o,G.P8(e.path)),size:e.size};default:return(0,j.Z)(e)}}));m&&P.unshift({type:"dir",name:"..",to:w.bucketPackageTree(a,r,o,G.up(m))});var V=C.children.map((function(e){return"PackageFile"===e.__typename?(0,t.pi)((0,t.pi)({},G.UD(e.physicalKey)),{logicalKey:e.path}):null})).filter(Boolean),O=m?"package/".concat(a,"/").concat(r,"/").concat(l,"/").concat(m):"package/".concat(a,"/").concat(r,"/").concat(l),M=null===(s=null===(u=null==_?void 0:_.ui)||void 0===u?void 0:u.actions)||void 0===s?void 0:s.revisePackage;return d.createElement(d.Fragment,null,te.render(),d.createElement(cn,{crumbs:v},M&&d.createElement(E.Z,{className:Z.button,variant:"contained",color:"primary",size:"small",style:{marginTop:-3,marginBottom:-3,flexShrink:0},onClick:function(){return T.open()}},"Revise package"),(null===(p=null===(k=null==_?void 0:_.ui)||void 0===k?void 0:k.actions)||void 0===p?void 0:p.copyPackage)&&d.createElement(Se.z,{className:Z.button,bucket:a,onChange:x},"Push to bucket"),d.createElement(Q.o,{className:Z.button,label:m?"Download sub-package":"Download package",onClick:ae.confirm,path:O}),d.createElement(Xe,{className:Z.button,onDelete:L,onDesktop:ae.confirm,onCreateFile:te.open})),(null===(f=null===(h=null==_?void 0:_.ui)||void 0===h?void 0:h.blocks)||void 0===f?void 0:f.code)&&d.createElement(ln,(0,t.pi)({},(0,t.pi)((0,t.pi)({},X),{hashOrTag:o,path:m}))),(null===(N=null===(y=null==_?void 0:_.ui)||void 0===y?void 0:y.blocks)||void 0===N?void 0:N.meta)&&d.createElement(ee.uv,{data:z.Z.Ok(C.metadata)}),d.createElement(g.Z,{mt:2},(null===(D=null===(S=null==_?void 0:_.ui)||void 0===S?void 0:S.blocks)||void 0===D?void 0:D.browser)&&d.createElement(ne.ZP,{items:P,key:l}),d.createElement(De.Z,{path:m,files:V,mkUrl:F,packageHandle:X})))}}))}function mn(e){var n=e.crumbs;return d.createElement(d.Fragment,null,d.createElement(cn,{crumbs:n}),d.createElement(g.Z,{mt:2},d.createElement(f.Z,null)))}function dn(e){var n=e.crumbs,a=e.detail,t=e.headline;return d.createElement(d.Fragment,null,d.createElement(cn,{crumbs:n}),d.createElement(g.Z,{mt:4},d.createElement(b.Z,{variant:"h4",align:"center",gutterBottom:!0},t),!!a&&d.createElement(b.Z,{variant:"body1",align:"center"},a)))}function kn(e){var n=e.bucket,a=e.name,i=e.hash,r=e.path,l=e.crumbs,o=(0,t._T)(e,["bucket","name","hash","path","crumbs"]),c=(0,Y.aM)({query:tn,variables:{bucket:n,name:a,hash:i,path:r}});return c.case({fetching:function(){return d.createElement(mn,{crumbs:l})},data:function(e){var u,s,m=null===(s=null===(u=e.package)||void 0===u?void 0:u.revision)||void 0===s?void 0:s.file;return m?d.createElement(pn,(0,t.pi)({},{bucket:n,name:a,hash:i,path:r,crumbs:l,file:m},o)):(c.error&&console.error(c.error),d.createElement(dn,{headline:"Error loading file",detail:"Seems like there's no such file in this package",crumbs:l}))}})}var vn=h.Z((function(e){var n;return{button:{marginLeft:e.spacing(2)},fileProperties:(n={},n[e.breakpoints.up("sm")]={marginBottom:"3px"},n)}}));function pn(e){var n,a,i=e.bucket,r=e.mode,l=e.name,o=e.hash,c=e.hashOrTag,u=e.path,s=e.crumbs,m=e.file,v=I.S3.use(),p=_.D$().noDownload,h=k.k6(),g=$.D$().urls,f=vn(),b=B.D$(),E=d.useMemo((function(){return{bucket:i,name:l,hash:o}}),[i,l,o]),y=(0,Pe.C)(u,r,E),N=d.useCallback((function(e){h.push(g.bucketPackageTree(i,l,c,u,e.valueOf()))}),[i,h,l,u,c,g]),w=S.wt(u)&&"latest"===c&&!!(null===(a=null===(n=null==b?void 0:b.ui)||void 0===n?void 0:n.actions)||void 0===a?void 0:a.revisePackage),Z=d.useCallback((function(){var e=g.bucketPackageDetail(i,l,{action:"revisePackage"}),n=G.UD(m.physicalKey),a=g.bucketFile(n.bucket,n.key,{add:u,edit:!0,next:e});h.push(a)}),[m,i,h,l,u,g]),D=d.useMemo((function(){return(0,t.pi)((0,t.pi)({},G.UD(m.physicalKey)),{logicalKey:m.path,packageHandle:E})}),[m,E]);return d.createElement(W.ZP,{fetch:ve.cY,params:(0,t.pi)({s3:v},D)},z.Z.case({_:function(){return d.createElement(mn,{crumbs:s})},Err:function(e){return"Forbidden"===e.code?d.createElement(dn,{headline:"Access Denied",detail:"You don't have access to this object",crumbs:s}):(console.error(e),d.createElement(dn,{headline:"Error loading file",detail:"Something went wrong",crumbs:s}))},Ok:ve.NB.case({Exists:function(e){var n,a,i,r,l=e.archived,o=e.deleted,k=e.lastModified,v=e.size;return d.createElement(d.Fragment,null,d.createElement(cn,{crumbs:s},d.createElement(X.E,{className:f.fileProperties,lastModified:k,size:v}),w&&d.createElement(ee.gN,{className:f.button,icon:"edit",label:"Edit",onClick:Z}),!!y.modes.length&&d.createElement(ee.Us,{className:f.button,options:y.modes.map(Pe.D),value:(0,Pe.D)(y.mode),onChange:N}),!p&&!o&&!l&&d.createElement(ee.o6,{className:f.button,handle:D})),(null===(a=null===(n=null==b?void 0:b.ui)||void 0===n?void 0:n.blocks)||void 0===a?void 0:a.code)&&d.createElement(ln,(0,t.pi)({},(0,t.pi)((0,t.pi)({},E),{hashOrTag:c,path:u}))),(null===(r=null===(i=null==b?void 0:b.ui)||void 0===i?void 0:i.blocks)||void 0===r?void 0:r.meta)&&d.createElement(ee.mE,{data:z.Z.Ok(m.metadata)}),d.createElement(Ze.Z,{icon:"remove_red_eye",heading:"Preview",expandable:!1},function(e,n,a,t){var i=e.archived;if(e.deleted)return t(z.Z.Err(C.Mh.Deleted({handle:n})));if(i)return t(z.Z.Err(C.Mh.Archived({handle:n})));var r={mode:a,context:C.IT.FILE};return C.zD(n,t,r)}({archived:l,deleted:o},D,y.mode,(0,Te.Z)(y.handlePreviewResult))))},_:function(){return d.createElement(dn,{headline:"No Such Object",crumbs:s})}})}))}function hn(e){var n=e.bucket,a=e.name,i=e.hash,r=e.children,l=p.m8(),o=d.useCallback((function(e){return l.query(tn,{bucket:n,name:a,hash:i,path:e}).toPromise().then((function(n){var a,i,r,l=null===(r=null===(i=null===(a=n.data)||void 0===a?void 0:a.package)||void 0===i?void 0:i.revision)||void 0===r?void 0:r.file;if(!l)throw n.error||new Error('Could not resolve logical key "'.concat(e,'"'));return(0,t.pi)((0,t.pi)({},G.UD(l.physicalKey)),{logicalKey:l.path,size:l.size})}))}),[l,n,a,i]);return d.createElement(L.zt,{value:o},r)}var gn,fn,bn,En=h.Z({alertMsg:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}});function yn(e){var n=e.bucket,a=e.name,i=e.hashOrTag,r=e.hash,l=e.path,o=e.mode,c=e.resolvedFrom,u=e.revisionListQuery,s=e.size,k=En(),p=$.D$().urls,h=G.vb(l),f=d.useMemo((function(){var e=(0,t.ev)([{label:"ROOT",path:""}],G.tO(l),!0);return m.Z(Z.$2.Sep(d.createElement(d.Fragment,null," / ")),e.map((function(e){var t=e.label,r=e.path;return Z.$2.Segment({label:t,to:l===r?void 0:p.bucketPackageTree(n,a,i,r)})}))).concat(l.endsWith("/")?Z.$2.Sep(d.createElement(d.Fragment,null," /")):[])}),[n,a,i,l,p]);return d.createElement(ee.fC,null,!!c&&d.createElement(g.Z,{mb:2},d.createElement(w.Z,{severity:"info",icon:!1,classes:{message:k.alertMsg},action:d.createElement(y.Z,{size:"small",color:"inherit",component:v.Link,to:p.bucketPackageTree(n,a,i,l)},d.createElement(N.Z,{fontSize:"small"},"close"))},"Resolved from"," ",d.createElement(g.Z,{fontFamily:"monospace.fontFamily",fontWeight:"fontWeightBold",component:"span",title:c},c))),d.createElement(b.Z,{variant:"body1"},d.createElement(xe,(0,t.pi)({},{bucket:n,name:a}))," @ ",d.createElement(Ke,(0,t.pi)({},{hash:r,hashOrTag:i,bucket:n,name:a,path:l,revisionListQuery:u}))),r?d.createElement(hn,(0,t.pi)({},{bucket:n,name:a,hash:r}),h?d.createElement(sn,(0,t.pi)({},{bucket:n,name:a,hash:r,path:l,hashOrTag:i,crumbs:f,size:s})):d.createElement(kn,(0,t.pi)({},{bucket:n,mode:o,name:a,hash:r,hashOrTag:i,path:l,crumbs:f}))):d.createElement(d.Fragment,null,d.createElement(cn,{crumbs:f}),d.createElement(g.Z,{mt:4},d.createElement(b.Z,{variant:"h4",align:"center",gutterBottom:!0},"Error resolving revision"),d.createElement(b.Z,{variant:"body1",align:"center"},"Revision"," ",d.createElement(g.Z,{component:"span",fontWeight:"fontWeightMedium"},'"'.concat(i,'"'))," ","could not be resolved."))))}function Nn(e){var n=e.bucket,a=e.name,i=e.hashOrTag,r=e.path,l=e.resolvedFrom,o=e.mode,c=(0,Y.aM)({query:en,variables:{bucket:n,name:a,hashOrTag:i}}),u=(0,Y.aM)({query:nn,variables:{bucket:n,name:a}});return c.case({fetching:function(){return d.createElement(F.Z,{color:"text.secondary"})},error:function(e){return Ce.Sj()(e)},data:function(e){var c,s,m;return e.package?d.createElement(yn,(0,t.pi)({},{bucket:n,name:a,hashOrTag:i,hash:null===(c=e.package.revision)||void 0===c?void 0:c.hash,size:null!==(m=null===(s=e.package.revision)||void 0===s?void 0:s.totalBytes)&&void 0!==m?m:void 0,path:r,mode:o,resolvedFrom:l,revisionListQuery:u})):d.createElement(D.Z,{headline:"No Such Package"},"Package named"," ",d.createElement(g.Z,{component:"span",fontWeight:"fontWeightMedium"},'"'.concat(a,'"'))," ","could not be found in this bucket.")}})}function wn(e){var n=e.match.params,a=n.bucket,i=n.name,r=n.revision,l=void 0===r?"latest":r,c=n.path,u=void 0===c?"":c,s=e.location,m=G.Jx(u),k=(0,H.Z)(s.search,!0),v=k.resolvedFrom,p=k.mode;return d.createElement(d.Fragment,null,d.createElement(U.Z,null,["".concat(i,"@").concat(o.Z(10,l),"/").concat(m),a]),d.createElement(Fe.Z,{bucket:a},d.createElement(Nn,(0,t.pi)({},{bucket:a,name:i,hashOrTag:l,path:m,resolvedFrom:v,mode:p}))))}},41973:(e,n,a)=>{a.d(n,{Z:()=>o});var t=a(67294),i=a(20740),r=a(37894),l=a(766);function o(e){var n=e.bucket,a=e.children,o="LOCAL"===l.D$().mode,c=r.TM();return t.useMemo((function(){return c(n)}),[n,c])||o?t.createElement(t.Fragment,null,a):t.createElement(i.Z,{headline:"Packages temporarily hidden"},"Ask an admin to add the bucket ",t.createElement("strong",null,n)," to Quilt so that you can browse packages.")}},64395:(e,n,a)=>{a.d(n,{C:()=>k,D:()=>d});var t=a(26470),i=a(67294),r=a(78013),l=a(43987),o=a(766),c=a(28238),u=c.SN({name:"Voila",persist:!0,fetch:function(e){return fetch(function(e){return"".concat(e,"/voila/")}(e)).then((function(e){return e.ok})).catch((function(){return!1})).then((function(e){return e||console.debug("Voila is not supported by current stack"),e}))}});var s={igv:"IGV",json:"JSON",jupyter:"Jupyter",vega:"Vega",voila:"Voila"},m=function(e){return!!e&&!!e.match(/https:\/\/vega\.github\.io\/schema\/([\w-]+)\/([\w.-]+)\.json/)};function d(e){return e&&{toString:function(){return s[e]},valueOf:function(){return e}}}function k(e,n,a){var s,d=(s=o.D$().registryUrl,c.et(u,s,{suspend:!0})),k=i.useState(null),v=k[0],p=k[1],h=i.useCallback((function(e){!v&&l.Z.Ok.is(e)&&p(l.Z.Ok.unbox(e))}),[v,p]),g=i.useMemo((function(){switch((0,t.extname)(e)){case".ipynb":return a&&d?["jupyter","json","voila"]:["jupyter","json"];case".json":return r.BO.case({Vega:function(e){var n;return m(null===(n=e.spec)||void 0===n?void 0:n.$schema)?["vega","json"]:[]},Json:function(e){var n;return m(null===(n=e.rendered)||void 0===n?void 0:n.$schema)?["vega","json"]:function(e){return Array.isArray(null==e?void 0:e.tracks)}(e.rendered)?["json","igv"]:[]},_:function(){return[]},__:function(){return[]}},v);default:return[]}}),[e,a,v,d]),f=g.includes(n)?n:g[0]||null;return{modes:g,mode:f,handlePreviewResult:h}}},55743:(e,n,a)=>{a.d(n,{Pz:()=>s,Qc:()=>u});var t=a(70655),i=a(17673),r=a(8575),l=a(66115),o=a(45596),c=function(e){function n(n,a){return e.call(this,"Invalid package URI (".concat(a,"): ").concat(n),{msg:n,uri:a})||this}return(0,t.ZT)(n,e),n.displayName="PackageUriError",n}(a(36155).G);function u(e){var n=(0,r.parse)(e);if("quilt+s3:"!==n.protocol)throw new c('unsupported protocol "'.concat(n.protocol,'". "quilt+s3:" is currently the only supported protocol.'),e);if(!n.slashes)throw new c("missing slashes between protocol and registry.",e);if(n.path)throw new c("non-bucket-root registries are not supported currently.",e);var a=n.host,t=(0,i.parse)((n.hash||"").replace("#",""));if(!t.package)throw new c('missing "package=" part.',e);if(Array.isArray(t.package))throw new c('"package=" specified multiple times.',e);var u=function(e,n){if(e.includes(":")&&e.includes("@"))throw new c('"package=" part may either contain ":" or "@".',n);if(e.includes(":")){var a=e.split(":"),t=a[0],i=a[1],r=a.slice(2);if(!t)throw new c('"package=" part must contain non-empty package name.',n);if(!i)throw new c('"package=" part: tag must not be empty.',n);if(r.length)throw new c('"package=" part may contain only one ":".',n);return{name:t,tag:i}}if(e.includes("@")){var l=e.split("@"),o=(t=l[0],l[1]);if(r=l.slice(2),!t)throw new c('"package=" part must contain non-empty package name.',n);if(!o)throw new c('"package=" part: hash must not be empty.',n);if(r.length)throw new c('"package=" part may contain only one "@".',n);return{name:t,hash:o}}return{name:e}}(t.package,e),s=u.name,m=u.hash,d=u.tag;if(Array.isArray(t.path))throw new c('"path=" specified multiple times.',e);var k=t.path?decodeURIComponent(t.path):void 0;return l.Z(o.Z,{bucket:a,name:s,hash:m,tag:d,path:k})}function s(e){var n=e.bucket,a=e.name,t=e.hash,i=e.tag,r=e.path;if(!n)throw new Error('PackageUri.stringify: missing "bucket"');if(!a)throw new Error('PackageUri.stringify: missing "name"');if(t&&i)throw new Error('PackageUri.stringify: can\'t have both "hash" and "tag"');var l=a;t?l+="@".concat(t):i&&(l+=":".concat(i));var o=r?"&path=".concat(encodeURIComponent(r)):"";return"quilt+s3://".concat(n,"#package=").concat(l).concat(o)}},9982:(e,n,a)=>{a.d(n,{Z:()=>m});var t=a(67294),i=a(11476),r=a(22318),l=a(95477),o=a(33261),c=i.Z("div")({textAlign:"center",width:"100%"}),u=function(e){var n=e.heading,a=e.body,i=e.action;return t.createElement(c,null,!!n&&t.createElement(r.Z,{variant:"h6",gutterBottom:!0},n),!!a&&t.createElement(r.Z,{variant:"body1",gutterBottom:!0},a),!!i&&i)},s=function(){return t.createElement(c,null,t.createElement(l.Z,null))};const m=function(e){return o.jf({renderMessage:u,renderProgress:s,onData:e})}}}]);
//# sourceMappingURL=582.20da6e1bc42c5a6ba6c8.chunk.js.map