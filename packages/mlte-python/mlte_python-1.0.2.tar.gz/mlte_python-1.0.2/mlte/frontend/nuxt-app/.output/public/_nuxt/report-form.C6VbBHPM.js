import{_ as N}from"./info-icon.DYvDc9G1.js";import{u as O,a as M,_ as z,d as G,b as H,c as L}from"./system-requirements.vue.Ca2bwrMl.js";import{n as Q,u as K,r as q,H as r,v as Z,q as T,A as B,w as y,B as j,o as d,d as f,y as n,C as J,b as m,x as W,a,c as b,s as X,t as p,F as Y,z as ee}from"./entry.CcvhsfqQ.js";import{u as te}from"./fetch.Bvj9IF8C.js";import{r as U,h as $}from"./http-error-handling.BbcmLHJS.js";import{a as w}from"./artifact-validation.BNGJNruX.js";import{f as ae}from"./util.xiPO2uKL.js";import{l as oe,c as se,s as ne}from"./form-methods.D-YS39W_.js";const le=a("title",null,"Report",-1),re=a("br",null,null,-1),ie=a("h2",{class:"section-header"},"Test Results (Quantitative Analysis)",-1),ue={class:"table usa-table usa-table--borderless"},ce=a("thead",null,[a("tr",null,[a("th",{"data-sortable":"",scope:"col",role:"columnheader"},"Status"),a("th",{"data-sortable":"",scope:"col",role:"columnheader"},"Property"),a("th",{"data-sortable":"",scope:"col",role:"columnheader"},"Measurement"),a("th",{"data-sortable":"",scope:"col",role:"columnheader"},"Evidence ID"),a("th",{"data-sortable":"",scope:"col",role:"columnheader"},"Message")])],-1),de={key:0,style:{"background-color":"rgba(210, 232, 221, 255)"}},me={key:1,style:{"background-color":"rgba(255, 243, 205, 255)"}},pe={key:2,style:{"background-color":"rgba(248, 216, 219, 255)"}},_e={key:3},ye=a("hr",null,null,-1),fe=a("h1",{class:"section-header"},"Additional Context",-1),ve={style:{"text-align":"right","margin-top":"1em"}},Se=Q({__name:"report-form",async setup(be){let R,F;const S=ee(),V=K("token"),h=q(""),x=q(r().query.artifactId!==void 0),C=q(null),s=q({artifact_type:"report",nc_data:{system:{goals:[{description:"",metrics:[{description:"",baseline:""}]}],problem_type:"classification",task:"",usage_context:"",risks:{fp:"",fn:"",other:""}},data:[{description:"",source:"",classification:"unclassified",access:"",labeling_method:"",labels:[{name:"",description:"",percentage:0}],fields:[{name:"",description:"",type:"",expected_values:"",missing_values:"",special_values:""}],rights:"",policies:""}],model:{development_compute_resources:{gpu:"0",cpu:"0",memory:"0",storage:"0"},deployment_platform:"",capability_deployment_mechanism:"",input_specification:[{name:"",description:"",type:"",expected_values:""}],output_specification:[{name:"",description:"",type:"",expected_values:""}],production_compute_resources:{gpu:"0",cpu:"0",memory:"0",storage:"0"}},system_requirements:[{quality:"<System Quality>",stimulus:"<Stimulus>",source:"<Source>",environment:"<Environment>",response:"<Response>",measure:"<Response Measure>"}]},validated_spec_id:"",comments:[{content:""}],quantitative_analysis:{}}),A=O(),E=M();if(r().query.artifactId!==void 0){const i=r().query.model,t=r().query.version,u=r().query.artifactId;[R,F]=Z(async()=>te(S.public.apiPath+"/model/"+i+"/version/"+t+"/artifact/"+u,{retry:0,method:"GET",headers:{Authorization:"Bearer "+V.value},onRequestError(){U()},async onResponse({response:o}){var _,c;if(o.ok&&w(o._data)){s.value=o._data.body;const g=o._data.body.nc_data.system.problem_type;if(((_=E.value.find(l=>l.value===g))==null?void 0:_.value)!==void 0&&(s.value.nc_data.system.problem_type=(c=E.value.find(l=>l.value===g))==null?void 0:c.value),o._data.body.nc_data.data.forEach(l=>{var k,e;const v=l.classification;((k=A.value.find(I=>I.value===v))==null?void 0:k.value)!==void 0&&(l.classification=(e=A.value.find(I=>I.value===v))==null?void 0:e.value)}),o._data.body.validated_spec_id){s.value.validated_spec_id=o._data.body.validated_spec_id;const l=await ae(V.value,i,t,s.value.validated_spec_id);C.value=oe(l)}}},onResponseError({response:o}){$(o.status,o._data.error_description)}},"$gSGc1Ze9fK")),await R,F()}async function P(){var _;const i=r().query.model,t=r().query.version;let u="";r().query.artifactId===void 0?u=h.value:u=(_=r().query.artifactId)==null?void 0:_.toString();const o={header:{identifier:u,type:"report",timestamp:-1,creator:""},body:s.value};if(w(o))try{await $fetch(S.public.apiPath+"/model/"+i+"/version/"+t+"/artifact",{retry:0,method:"POST",headers:{Authorization:"Bearer "+V.value},body:{artifact:o,force:x.value,parents:!1},onRequestError(){U()},onResponseError({response:c}){c.status===409?conflictErrorAlert():$(c.status,c._data.error_description)}}),ne("report",u),x.value=!0}catch{}else console.log("Invalid report.")}function D(){alert("Report export is not currently implemented.")}return(i,t)=>{const u=N,o=T("UsaTextInput"),_=z,c=G,g=H,l=L,v=T("UsaButton"),k=j;return d(),B(k,{name:"base-layout"},{"page-title":y(()=>[f("Report")]),default:y(()=>[le,("useRoute"in i?i.useRoute:n(r))().query.artifactId===void 0?(d(),B(o,{key:0,modelValue:n(h),"onUpdate:modelValue":t[0]||(t[0]=e=>J(h)?h.value=e:null)},{label:y(()=>[f(" Artifact ID "),m(u,null,{default:y(()=>[f(" The Artifact ID this negotiation card "),re,f(" will be saved under upon submission. ")]),_:1})]),_:1},8,["modelValue"])):W("",!0),m(_,{modelValue:n(s).nc_data.system,"onUpdate:modelValue":t[1]||(t[1]=e=>n(s).nc_data.system=e)},null,8,["modelValue"]),m(c,{modelValue:n(s).nc_data.system_requirements,"onUpdate:modelValue":t[2]||(t[2]=e=>n(s).nc_data.system_requirements=e)},null,8,["modelValue"]),ie,a("table",ue,[ce,a("tbody",null,[(d(!0),b(Y,null,X(n(C),e=>(d(),b("tr",{key:e.evidence_id},[e.status=="Success"?(d(),b("td",de,p(e.status),1)):e.status=="Ignore"?(d(),b("td",me,p(e.status),1)):e.status=="Failure"?(d(),b("td",pe,p(e.status),1)):(d(),b("td",_e,p(e.status),1)),a("td",null,p(e.property),1),a("td",null,p(e.measurement),1),a("td",null,p(e.evidence_id),1),a("td",null,p(e.message),1)]))),128))])]),ye,fe,m(g,{modelValue:n(s).nc_data.data,"onUpdate:modelValue":t[3]||(t[3]=e=>n(s).nc_data.data=e)},null,8,["modelValue"]),m(l,{modelValue:n(s).nc_data.model,"onUpdate:modelValue":t[4]||(t[4]=e=>n(s).nc_data.model=e)},null,8,["modelValue"]),a("div",ve,[m(v,{class:"secondary-button",onClick:t[5]||(t[5]=e=>("cancelFormSubmission"in i?i.cancelFormSubmission:n(se))("/"))},{default:y(()=>[f(" Cancel ")]),_:1}),m(v,{class:"primary-button",disabled:"",onClick:t[6]||(t[6]=e=>D())},{default:y(()=>[f(" Export ")]),_:1}),m(v,{class:"primary-button",onClick:t[7]||(t[7]=e=>P())},{default:y(()=>[f(" Save ")]),_:1})])]),_:1})}}});export{Se as default};
