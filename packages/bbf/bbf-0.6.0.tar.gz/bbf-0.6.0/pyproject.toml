[build-system]
requires = ["scikit-build-core >=0.4.3", "nanobind >=1.3.2"]
build-backend = "scikit_build_core.build"


[project]
name = "bbf"
dynamic = ["version"]
description = "Fast computation of broadband fluxes and magnitudes"
readme = "README.md"
authors = [
        { name = "Nicolas Regnault", email = "nicolas.regnault@lpnhe.in2p3.fr" },
]
classifiers = [
    "Development Status :: 2 - Pre-Alpha",
    "Intended Audience :: Science/Research",
    "License :: OSI Approved :: MIT License",
    "Programming Language :: Python :: 3",
    "Topic :: Scientific/Engineering :: Astronomy",
    "Topic :: Scientific/Engineering :: Physics"
]
keywords = ["astronomy", "astrophysics"]
license = { file = "LICENSE" }

requires-python = ">=3.9"
dependencies = [
    "astropy",
    "astroquery",
    "fastparquet",
    "gaiaxpy",
    "getCalspec",
    "healpy",
    "matplotlib",
    "numpy",
    "pandas",
    "platformdirs",
    "pyifu",
    "scipy >= 1.10",
    "scikit-sparse",
    "sncosmo"  # for now we must rely on https://github.com/nregnault/sncosmo
]


[project.urls]
Homepage = "https://gitlab.in2p3.fr/lemaitre/bbf"
Repository = "https://gitlab.in2p3.fr/lemaitre/bbf"
Changelog = "https://gitlab.in2p3.fr/lemaitre/bbf/-/blob/main/CHANGELOG.md"


[project.optional-dependencies]
test = [
  "pytest>=6.0",
  "pytest-cov",
  "lemaitre-bandpasses>=0.3.3"]


[tool.scikit-build]
# Reads the minimal required cmake version from CMakeLists.txt (pip install it
# as needed)
cmake.version = "CMakeLists.txt"

# By default build an optimized version of the C extension
cmake.build-type = "Release"

# Protect the configuration against future changes in scikit-build-core
minimum-version = "0.4"

# Setuptools-style build caching in a local directory
build-dir = "build/{wheel_tag}"

# Build stable ABI wheels for CPython 3.12+
wheel.py-api = "cp312"

sdist.exclude = ["notebooks", "examples"]


[tool.scikit-build.metadata.version]
# Reads the version from bbf/__init__.py::__version__
provider = "scikit_build_core.metadata.regex"
input = "bbf/__init__.py"


[tool.pytest.ini_options]
minversion = "6.0"
testpaths = "tests"
python_files = ["tests/test_*.py"]

# configures doctests and coverage
addopts = """--cov=bbf --cov-report term --cov-report=html"""
