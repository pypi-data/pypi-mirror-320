import{r as o,E as X,_ as q,n as x,az as lt,ca as ut,D as Y,cl as I,A as f,am as z,j as u,bc as ct,bp as dt,bd as pt,aY as ft,be as bt,b9 as G}from"./index.BSITpAz8.js";import{s as mt}from"./sprintf.C-r3gIuM.js";import{u as gt}from"./uniqueId.BNjI9ROI.js";import{u as yt}from"./FormClearHelper.Tmz_sTQ8.js";import{I as It}from"./InputInstructions.CWlmC2Qh.js";import{I as ht}from"./input.qSadM7Tx.js";import"./base-input.C7heAUz7.js";var J=o.forwardRef(function(t,e){var r={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};return o.createElement(X,q({iconAttrs:r,iconVerticalAlign:"middle",iconViewBox:"0 0 8 8"},t,{ref:e}),o.createElement("path",{d:"M0 3v2h8V3H0z"}))});J.displayName="Minus";var Q=o.forwardRef(function(t,e){var r={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};return o.createElement(X,q({iconAttrs:r,iconVerticalAlign:"middle",iconViewBox:"0 0 8 8"},t,{ref:e}),o.createElement("path",{d:"M3 0v3H0v2h3v3h2V5h3V3H5V0H3z"}))});Q.displayName="Plus";const wt=x("div",{target:"eiawb8t0"})(({theme:t})=>({display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"center",height:t.sizes.minElementHeight,borderWidth:t.sizes.borderWidth,borderStyle:"solid",borderColor:t.colors.widgetBorderColor||t.colors.widgetBackgroundColor||t.colors.bgColor,transitionDuration:"200ms",transitionProperty:"border",transitionTimingFunction:"cubic-bezier(0.2, 0.8, 0.4, 1)",borderRadius:t.radii.default,overflow:"hidden","&.focused":{borderColor:t.colors.primary},input:{MozAppearance:"textfield","&::-webkit-inner-spin-button, &::-webkit-outer-spin-button":{WebkitAppearance:"none",margin:t.spacing.none}}})),Ct=x("div",{target:"eiawb8t1"})({display:"flex",flexDirection:"row",alignSelf:"stretch"}),K=x("button",{target:"eiawb8t2"})(({theme:t})=>({margin:t.spacing.none,border:"none",height:t.sizes.full,display:"flex",alignItems:"center",width:t.sizes.numberInputControlsWidth,justifyContent:"center",color:t.colors.bodyText,transition:"color 300ms, backgroundColor 300ms",backgroundColor:t.colors.widgetBackgroundColor||t.colors.secondaryBg,"&:hover:enabled, &:focus:enabled":{color:t.colors.white,backgroundColor:t.colors.primary,transition:"none",outline:"none"},"&:active":{outline:"none",border:"none"},"&:last-of-type":{borderTopRightRadius:t.radii.default,borderBottomRightRadius:t.radii.default},"&:disabled":{cursor:"not-allowed",color:t.colors.fadedText40}})),Tt=x("div",{target:"eiawb8t3"})(({theme:t,clearable:e})=>({position:"absolute",marginRight:t.spacing.twoXS,left:0,right:`calc(${t.sizes.numberInputControlsWidth} * 2 + ${e?"1em":"0em"})`}));function St(t){return f(t)||t===""?void 0:t}const Vt=t=>(t.element.dataType===I.DataType.INT?t.widgetMgr.getIntValue(t.element):t.widgetMgr.getDoubleValue(t.element))??t.element.default??null,M=({step:t,dataType:e})=>t||(e===I.DataType.INT?1:.01),W=({value:t,format:e,step:r,dataType:h})=>{if(f(t))return null;let n=St(e);if(f(n)&&Y(r)){const c=r.toString();h===I.DataType.FLOAT&&r!==0&&c.includes(".")&&(n=`%0.${c.split(".")[1].length}f`)}if(f(n))return t.toString();try{return mt.sprintf(n,t)}catch{return String(t)}},vt=(t,e,r)=>f(t)?!1:t-e>=r,kt=(t,e,r)=>f(t)?!1:t+e<=r,xt=({disabled:t,element:e,widgetMgr:r,width:h,theme:n,fragmentId:c})=>{var j;const{dataType:T,id:D,formId:p,default:B,format:A}=e,b=e.hasMin?e.min:-1/0,m=e.hasMax?e.max:1/0,[i,Z]=o.useState(M(e)),U=Vt({element:e,widgetMgr:r}),[g,w]=o.useState(!1),[s,C]=o.useState(U),[H,S]=o.useState(W({value:U,...e,step:i})),[P,L]=o.useState(!1),R=o.useRef(null),O=o.useRef(gt("number_input_")),V=vt(s,i,b),v=kt(s,i,m),_=ut({formId:p}),tt=_?r.allowFormEnterToSubmit(p):g,et=P&&h>n.breakpoints.hideWidgetDetails;o.useEffect(()=>{Z(M({step:e.step,dataType:e.dataType}))},[e.dataType,e.step]);const l=o.useCallback(({value:a,source:d})=>{var y;if(Y(a)&&(b>a||a>m))(y=R.current)==null||y.reportValidity();else{const k=a??B??null;switch(T){case I.DataType.INT:r.setIntValue({id:D,formId:p},k,d,c);break;case I.DataType.FLOAT:r.setDoubleValue({id:D,formId:p},k,d,c);break;default:throw new Error("Invalid data type")}w(!1),C(k),S(W({value:k,dataType:T,format:A,step:i}))}},[b,m,R,r,c,i,T,D,p,B,A]),ot=o.useCallback(()=>{g&&l({value:s,source:{fromUi:!0}}),L(!1)},[g,s,l]),rt=o.useCallback(()=>{L(!0)},[]),$=o.useCallback(()=>{const{value:a}=e;e.setValue=!1,C(a??null),S(W({value:a??null,...e,step:i})),l({value:a??null,source:{fromUi:!1}})},[e,i,l]);o.useEffect(()=>{e.setValue?$():l({value:s,source:{fromUi:!1}})},[]),e.setValue&&$();const N=f(e.default)&&!t,at=o.useCallback(()=>{const a=e.default??null;C(a),l({value:a,source:{fromUi:!0}})},[e]);yt({element:e,widgetMgr:r,onFormCleared:at});const nt=a=>{const{value:d}=a.target;if(d==="")w(!0),C(null),S(null);else{let y;e.dataType===I.DataType.INT?y=parseInt(d,10):y=parseFloat(d),w(!0),C(y),S(d)}},F=o.useCallback(()=>{v&&(w(!0),l({value:(s??b)+i,source:{fromUi:!0}}))},[s,b,i,v]),E=o.useCallback(()=>{V&&(w(!0),l({value:(s??m)-i,source:{fromUi:!0}}))},[s,m,i,V]),it=o.useCallback(a=>{const{key:d}=a;switch(d){case"ArrowUp":a.preventDefault(),F();break;case"ArrowDown":a.preventDefault(),E();break}},[F,E]),st=o.useCallback(a=>{a.key==="Enter"&&(g&&l({value:s,source:{fromUi:!0}}),r.allowFormEnterToSubmit(p)&&r.submitForm(p,c))},[g,s,l,r,p,c]);return z("div",{className:"stNumberInput","data-testid":"stNumberInput",style:{width:h},children:[u(bt,{label:e.label,disabled:t,labelVisibility:ct((j=e.labelVisibility)==null?void 0:j.value),htmlFor:O.current,children:e.help&&u(dt,{children:u(pt,{content:e.help,placement:ft.TOP_RIGHT})})}),z(wt,{className:P?"focused":"","data-testid":"stNumberInputContainer",children:[u(ht,{type:"number",inputRef:R,value:H??"",placeholder:e.placeholder,onBlur:ot,onFocus:rt,onChange:nt,onKeyPress:st,onKeyDown:it,clearable:N,clearOnEscape:N,disabled:t,"aria-label":e.label,id:O.current,overrides:{ClearIconContainer:{style:{padding:0}},ClearIcon:{props:{overrides:{Svg:{style:{color:n.colors.darkGray,padding:n.spacing.threeXS,height:n.sizes.clearIconSize,width:n.sizes.clearIconSize,":hover":{fill:n.colors.bodyText}}}}}},Input:{props:{"data-testid":"stNumberInputField",step:i,min:b,max:m,type:"number",inputMode:""},style:{lineHeight:n.lineHeights.inputWidget,paddingRight:n.spacing.sm,paddingLeft:n.spacing.sm,paddingBottom:n.spacing.sm,paddingTop:n.spacing.sm}},InputContainer:{style:()=>({borderTopRightRadius:0,borderBottomRightRadius:0})},Root:{style:{borderTopRightRadius:0,borderBottomRightRadius:0,borderLeftWidth:0,borderRightWidth:0,borderTopWidth:0,borderBottomWidth:0,paddingRight:0}}}}),h>n.breakpoints.hideNumberInputControls&&z(Ct,{children:[u(K,{"data-testid":"stNumberInputStepDown",onClick:E,disabled:!V||t,tabIndex:-1,children:u(G,{content:J,size:"xs",color:V?"inherit":"disabled"})}),u(K,{"data-testid":"stNumberInputStepUp",onClick:F,disabled:!v||t,tabIndex:-1,children:u(G,{content:Q,size:"xs",color:v?"inherit":"disabled"})})]})]}),et&&u(Tt,{clearable:N,children:u(It,{dirty:g,value:H??"",inForm:_,allowEnterToSubmit:tt})})]})},Bt=lt(xt);export{Bt as default};
