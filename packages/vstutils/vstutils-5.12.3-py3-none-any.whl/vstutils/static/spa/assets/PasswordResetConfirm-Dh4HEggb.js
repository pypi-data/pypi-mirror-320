import{e as _,R as v,U as y,f as n,o as g,S as h,k as b}from"./index-DUdvmj-w.js";import{F as C}from"./FormGroup-DkpsYL_6.js";import{c as P,b as k}from"./index-DKlBORNq.js";const R=_({__name:"PasswordResetConfirm",setup(f){const s=v(),r=y(),e=P(),{i18n:a}=k(),t=n(!1),o=n(""),c=n(""),p=n(),d=n(""),m=n([]);g(()=>{h(()=>{var i,u;o.value!==c.value?(i=p.value)==null||i.setCustomValidity(`${a.t("Passwords do not match.")}`):(u=p.value)==null||u.setCustomValidity("")})});async function w(){t.value=!0;try{const i=new URL("oauth2/password_reset_confirm/",e.api.url);i.search=new URLSearchParams({lang:a.locale}).toString();const u=await fetch(i,{method:"POST",body:JSON.stringify({uid:r.params.uid,token:r.params.token,password:o.value}),headers:{"Content-Type":"application/json"}});if(!u.ok){const l=await u.json();if(l.password)m.value=l.password;else if(l.uid||l.token)d.value="Invalid link. Please request a new one.";else throw new Error("Invalid response");return}s.push({name:"login",replace:!0})}catch{d.value="An error occurred. Please try again later."}finally{t.value=!1}}return{__sfc:!0,router:s,route:r,config:e,i18n:a,isLoading:t,password:o,password2:c,password2El:p,error:d,passwordErrors:m,submit:w,FormGroup:C}}});var S=function(){var s=this,r=s._self._c,e=s._self._setupProxy;return r("form",{on:{submit:function(a){return a.preventDefault(),e.submit.apply(null,arguments)}}},[r("p",[s._v(" "+s._s(s.$t("Please enter your new password twice so we can verify you typed it in correctly."))+" ")]),r(e.FormGroup,{attrs:{label:`${s.$t("New password")}`,errors:e.passwordErrors},scopedSlots:s._u([{key:"default",fn:function({classes:a,id:t}){return[r("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],class:a,attrs:{id:t,type:"password",name:"password"},domProps:{value:e.password},on:{input:function(o){o.target.composing||(e.password=o.target.value)}}})]}}])}),r(e.FormGroup,{attrs:{label:`${s.$t("Confirm password")}`},scopedSlots:s._u([{key:"default",fn:function({classes:a,id:t}){return[r("input",{directives:[{name:"model",rawName:"v-model",value:e.password2,expression:"password2"}],ref:"password2El",class:a,attrs:{id:t,type:"password",name:"password2"},domProps:{value:e.password2},on:{input:function(o){o.target.composing||(e.password2=o.target.value)}}})]}}])}),e.error?r("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[s._v(" "+s._s(s.$t(e.error))+" ")]):s._e(),r("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.isLoading}},[s._v(" "+s._s(s.$t("Change my Password"))+" ")])],1)},$=[],E=b(R,S,$,!1,null,null);const N=E.exports;export{N as default};
