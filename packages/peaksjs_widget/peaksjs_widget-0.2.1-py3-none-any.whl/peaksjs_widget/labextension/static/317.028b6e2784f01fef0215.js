"use strict";(self.webpackChunkpeaksjs_widget=self.webpackChunkpeaksjs_widget||[]).push([[317],{317:(t,e,a)=>{function n(t,e){this._waveformData=t,this._channelIndex=e}a.r(e),a.d(e,{default:()=>i}),n.prototype.min_sample=function(t){var e=2*(t*this._waveformData.channels+this._channelIndex);return this._waveformData._at(e)},n.prototype.max_sample=function(t){var e=2*(t*this._waveformData.channels+this._channelIndex)+1;return this._waveformData._at(e)},n.prototype.set_min_sample=function(t,e){var a=2*(t*this._waveformData.channels+this._channelIndex);return this._waveformData._set_at(a,e)},n.prototype.set_max_sample=function(t,e){var a=2*(t*this._waveformData.channels+this._channelIndex)+1;return this._waveformData._set_at(a,e)},n.prototype.min_array=function(){return this._waveformData._offsetValues(0,this._waveformData.length,2*this._channelIndex)},n.prototype.max_array=function(){return this._waveformData._offsetValues(0,this._waveformData.length,2*this._channelIndex+1)};var s=127,g=-128;function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}var l,r=function(t){return l=l||function(t,e,a){var n=void 0===e?null:e,s=function(t,e){var a=atob(t);if(e){for(var n=new Uint8Array(a.length),s=0,g=a.length;s<g;++s)n[s]=a.charCodeAt(s);return String.fromCharCode.apply(null,new Uint16Array(n.buffer))}return a}(t,void 0!==a&&a),g=s.indexOf("\n",10)+1,I=s.substring(g)+(n?"//# sourceMappingURL="+n:""),l=new Blob([I],{type:"application/javascript"});return URL.createObjectURL(l)}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyoqCiAgICogQXVkaW9CdWZmZXItYmFzZWQgV2F2ZWZvcm1EYXRhIGdlbmVyYXRvcgogICAqCiAgICogQWRhcHRlZCBmcm9tIEJsb2NrRmlsZTo6Q2FsY1N1bW1hcnkgaW4gQXVkYWNpdHksIHdpdGggcGVybWlzc2lvbi4KICAgKiBTZWUgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9hdWRhY2l0eS9zb3VyY2UvYnJvd3NlL2F1ZGFjaXR5LXNyYy90cnVuay9zcmMvQmxvY2tGaWxlLmNwcAogICAqLwogIHZhciBJTlQ4X01BWCA9IDEyNzsKICB2YXIgSU5UOF9NSU4gPSAtMTI4OwoKICBmdW5jdGlvbiBjYWxjdWxhdGVXYXZlZm9ybURhdGFMZW5ndGgoYXVkaW9fc2FtcGxlX2NvdW50LCBzY2FsZSkgewogICAgdmFyIGRhdGFfbGVuZ3RoID0gTWF0aC5mbG9vcihhdWRpb19zYW1wbGVfY291bnQgLyBzY2FsZSk7CiAgICB2YXIgc2FtcGxlc19yZW1haW5pbmcgPSBhdWRpb19zYW1wbGVfY291bnQgLSBkYXRhX2xlbmd0aCAqIHNjYWxlOwoKICAgIGlmIChzYW1wbGVzX3JlbWFpbmluZyA+IDApIHsKICAgICAgZGF0YV9sZW5ndGgrKzsKICAgIH0KCiAgICByZXR1cm4gZGF0YV9sZW5ndGg7CiAgfQoKICBmdW5jdGlvbiBnZW5lcmF0ZVdhdmVmb3JtRGF0YShvcHRpb25zKSB7CiAgICB2YXIgc2NhbGUgPSBvcHRpb25zLnNjYWxlOwogICAgdmFyIGFtcGxpdHVkZV9zY2FsZSA9IG9wdGlvbnMuYW1wbGl0dWRlX3NjYWxlOwogICAgdmFyIHNwbGl0X2NoYW5uZWxzID0gb3B0aW9ucy5zcGxpdF9jaGFubmVsczsKICAgIHZhciBsZW5ndGggPSBvcHRpb25zLmxlbmd0aDsKICAgIHZhciBzYW1wbGVfcmF0ZSA9IG9wdGlvbnMuc2FtcGxlX3JhdGU7CiAgICB2YXIgY2hhbm5lbHMgPSBvcHRpb25zLmNoYW5uZWxzLm1hcChmdW5jdGlvbiAoY2hhbm5lbCkgewogICAgICByZXR1cm4gbmV3IEZsb2F0MzJBcnJheShjaGFubmVsKTsKICAgIH0pOwogICAgdmFyIG91dHB1dF9jaGFubmVscyA9IHNwbGl0X2NoYW5uZWxzID8gY2hhbm5lbHMubGVuZ3RoIDogMTsKICAgIHZhciB2ZXJzaW9uID0gb3V0cHV0X2NoYW5uZWxzID09PSAxID8gMSA6IDI7CiAgICB2YXIgaGVhZGVyX3NpemUgPSB2ZXJzaW9uID09PSAxID8gMjAgOiAyNDsKICAgIHZhciBkYXRhX2xlbmd0aCA9IGNhbGN1bGF0ZVdhdmVmb3JtRGF0YUxlbmd0aChsZW5ndGgsIHNjYWxlKTsKICAgIHZhciB0b3RhbF9zaXplID0gaGVhZGVyX3NpemUgKyBkYXRhX2xlbmd0aCAqIDIgKiBvdXRwdXRfY2hhbm5lbHM7CiAgICB2YXIgYnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKHRvdGFsX3NpemUpOwogICAgdmFyIGRhdGFfdmlldyA9IG5ldyBEYXRhVmlldyhidWZmZXIpOwogICAgdmFyIHNjYWxlX2NvdW50ZXIgPSAwOwogICAgdmFyIG9mZnNldCA9IGhlYWRlcl9zaXplOwogICAgdmFyIGNoYW5uZWwsIGk7CiAgICB2YXIgbWluX3ZhbHVlID0gbmV3IEFycmF5KG91dHB1dF9jaGFubmVscyk7CiAgICB2YXIgbWF4X3ZhbHVlID0gbmV3IEFycmF5KG91dHB1dF9jaGFubmVscyk7CgogICAgZm9yIChjaGFubmVsID0gMDsgY2hhbm5lbCA8IG91dHB1dF9jaGFubmVsczsgY2hhbm5lbCsrKSB7CiAgICAgIG1pbl92YWx1ZVtjaGFubmVsXSA9IEluZmluaXR5OwogICAgICBtYXhfdmFsdWVbY2hhbm5lbF0gPSAtSW5maW5pdHk7CiAgICB9CgogICAgZGF0YV92aWV3LnNldEludDMyKDAsIHZlcnNpb24sIHRydWUpOyAvLyBWZXJzaW9uCgogICAgZGF0YV92aWV3LnNldFVpbnQzMig0LCAxLCB0cnVlKTsgLy8gSXMgOCBiaXQ/CgogICAgZGF0YV92aWV3LnNldEludDMyKDgsIHNhbXBsZV9yYXRlLCB0cnVlKTsgLy8gU2FtcGxlIHJhdGUKCiAgICBkYXRhX3ZpZXcuc2V0SW50MzIoMTIsIHNjYWxlLCB0cnVlKTsgLy8gU2NhbGUKCiAgICBkYXRhX3ZpZXcuc2V0SW50MzIoMTYsIGRhdGFfbGVuZ3RoLCB0cnVlKTsgLy8gTGVuZ3RoCgogICAgaWYgKHZlcnNpb24gPT09IDIpIHsKICAgICAgZGF0YV92aWV3LnNldEludDMyKDIwLCBvdXRwdXRfY2hhbm5lbHMsIHRydWUpOwogICAgfQoKICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICB2YXIgc2FtcGxlID0gMDsKCiAgICAgIGlmIChvdXRwdXRfY2hhbm5lbHMgPT09IDEpIHsKICAgICAgICBmb3IgKGNoYW5uZWwgPSAwOyBjaGFubmVsIDwgY2hhbm5lbHMubGVuZ3RoOyArK2NoYW5uZWwpIHsKICAgICAgICAgIHNhbXBsZSArPSBjaGFubmVsc1tjaGFubmVsXVtpXTsKICAgICAgICB9CgogICAgICAgIHNhbXBsZSA9IE1hdGguZmxvb3IoSU5UOF9NQVggKiBzYW1wbGUgKiBhbXBsaXR1ZGVfc2NhbGUgLyBjaGFubmVscy5sZW5ndGgpOwoKICAgICAgICBpZiAoc2FtcGxlIDwgbWluX3ZhbHVlWzBdKSB7CiAgICAgICAgICBtaW5fdmFsdWVbMF0gPSBzYW1wbGU7CgogICAgICAgICAgaWYgKG1pbl92YWx1ZVswXSA8IElOVDhfTUlOKSB7CiAgICAgICAgICAgIG1pbl92YWx1ZVswXSA9IElOVDhfTUlOOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHNhbXBsZSA+IG1heF92YWx1ZVswXSkgewogICAgICAgICAgbWF4X3ZhbHVlWzBdID0gc2FtcGxlOwoKICAgICAgICAgIGlmIChtYXhfdmFsdWVbMF0gPiBJTlQ4X01BWCkgewogICAgICAgICAgICBtYXhfdmFsdWVbMF0gPSBJTlQ4X01BWDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yIChjaGFubmVsID0gMDsgY2hhbm5lbCA8IG91dHB1dF9jaGFubmVsczsgKytjaGFubmVsKSB7CiAgICAgICAgICBzYW1wbGUgPSBNYXRoLmZsb29yKElOVDhfTUFYICogY2hhbm5lbHNbY2hhbm5lbF1baV0gKiBhbXBsaXR1ZGVfc2NhbGUpOwoKICAgICAgICAgIGlmIChzYW1wbGUgPCBtaW5fdmFsdWVbY2hhbm5lbF0pIHsKICAgICAgICAgICAgbWluX3ZhbHVlW2NoYW5uZWxdID0gc2FtcGxlOwoKICAgICAgICAgICAgaWYgKG1pbl92YWx1ZVtjaGFubmVsXSA8IElOVDhfTUlOKSB7CiAgICAgICAgICAgICAgbWluX3ZhbHVlW2NoYW5uZWxdID0gSU5UOF9NSU47CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoc2FtcGxlID4gbWF4X3ZhbHVlW2NoYW5uZWxdKSB7CiAgICAgICAgICAgIG1heF92YWx1ZVtjaGFubmVsXSA9IHNhbXBsZTsKCiAgICAgICAgICAgIGlmIChtYXhfdmFsdWVbY2hhbm5lbF0gPiBJTlQ4X01BWCkgewogICAgICAgICAgICAgIG1heF92YWx1ZVtjaGFubmVsXSA9IElOVDhfTUFYOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoKytzY2FsZV9jb3VudGVyID09PSBzY2FsZSkgewogICAgICAgIGZvciAoY2hhbm5lbCA9IDA7IGNoYW5uZWwgPCBvdXRwdXRfY2hhbm5lbHM7IGNoYW5uZWwrKykgewogICAgICAgICAgZGF0YV92aWV3LnNldEludDgob2Zmc2V0KyssIG1pbl92YWx1ZVtjaGFubmVsXSk7CiAgICAgICAgICBkYXRhX3ZpZXcuc2V0SW50OChvZmZzZXQrKywgbWF4X3ZhbHVlW2NoYW5uZWxdKTsKICAgICAgICAgIG1pbl92YWx1ZVtjaGFubmVsXSA9IEluZmluaXR5OwogICAgICAgICAgbWF4X3ZhbHVlW2NoYW5uZWxdID0gLUluZmluaXR5OwogICAgICAgIH0KCiAgICAgICAgc2NhbGVfY291bnRlciA9IDA7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoc2NhbGVfY291bnRlciA+IDApIHsKICAgICAgZm9yIChjaGFubmVsID0gMDsgY2hhbm5lbCA8IG91dHB1dF9jaGFubmVsczsgY2hhbm5lbCsrKSB7CiAgICAgICAgZGF0YV92aWV3LnNldEludDgob2Zmc2V0KyssIG1pbl92YWx1ZVtjaGFubmVsXSk7CiAgICAgICAgZGF0YV92aWV3LnNldEludDgob2Zmc2V0KyssIG1heF92YWx1ZVtjaGFubmVsXSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gYnVmZmVyOwogIH0KCiAgb25tZXNzYWdlID0gZnVuY3Rpb24gb25tZXNzYWdlKGV2dCkgewogICAgdmFyIGJ1ZmZlciA9IGdlbmVyYXRlV2F2ZWZvcm1EYXRhKGV2dC5kYXRhKTsgLy8gVHJhbnNmZXIgYnVmZmVyIHRvIHRoZSBjYWxsaW5nIHRocmVhZAoKICAgIHRoaXMucG9zdE1lc3NhZ2UoYnVmZmVyLCBbYnVmZmVyXSk7CiAgICB0aGlzLmNsb3NlKCk7CiAgfTsKCn0pKCk7Cgo=",null,false),new Worker(l,t)};function i(t){if(function(t){return t&&"object"===I(t)&&"sample_rate"in t&&"samples_per_pixel"in t&&"bits"in t&&"length"in t&&"data"in t}(t)&&(t=function(t){var e=t.data,a=t.channels||1,n=8===t.bits?1:2,s=2*t.length*a;if(e.length!==s)throw new Error("WaveformData.create(): Length mismatch in JSON waveform data");var g=24+e.length*n,I=new ArrayBuffer(g),l=new DataView(I);l.setInt32(0,2,!0),l.setUint32(4,8===t.bits,!0),l.setInt32(8,t.sample_rate,!0),l.setInt32(12,t.samples_per_pixel,!0),l.setInt32(16,t.length,!0),l.setInt32(20,a,!0);var r,i=24;if(8===t.bits)for(r=0;r<e.length;r++)l.setInt8(i++,e[r],!0);else for(r=0;r<e.length;r++)l.setInt16(i,e[r],!0),i+=2;return I}(t)),!function(t){var e=t&&"object"===I(t)&&"byteLength"in t;if(e){var a=new DataView(t).getInt32(0,!0);if(1!==a&&2!==a)throw new TypeError("WaveformData.create(): This waveform data version not supported")}return e}(t))throw new TypeError("WaveformData.create(): Unknown data format");this._data=new DataView(t),this._offset=2===this._version()?24:20,this._channels=[];for(var e=0;e<this.channels;e++)this._channels[e]=new n(this,e)}function h(t,e,a){var n=function(t){for(var e=[],a=0;a<t.numberOfChannels;++a)e.push(t.getChannelData(a).buffer);return e}(t);if(e.disable_worker){var I=function(t){var e,a,n=t.scale,I=t.amplitude_scale,l=t.split_channels,r=t.length,i=t.sample_rate,h=t.channels.map((function(t){return new Float32Array(t)})),o=l?h.length:1,C=1===o?1:2,c=1===C?20:24,A=function(t,e){var a=Math.floor(t/e);return t-a*e>0&&a++,a}(r,n),m=new ArrayBuffer(c+2*A*o),b=new DataView(m),u=0,f=c,d=new Array(o),p=new Array(o);for(e=0;e<o;e++)d[e]=1/0,p[e]=-1/0;for(b.setInt32(0,C,!0),b.setUint32(4,1,!0),b.setInt32(8,i,!0),b.setInt32(12,n,!0),b.setInt32(16,A,!0),2===C&&b.setInt32(20,o,!0),a=0;a<r;a++){var W=0;if(1===o){for(e=0;e<h.length;++e)W+=h[e][a];(W=Math.floor(s*W*I/h.length))<d[0]&&(d[0]=W,d[0]<g&&(d[0]=g)),W>p[0]&&(p[0]=W,p[0]>s&&(p[0]=s))}else for(e=0;e<o;++e)(W=Math.floor(s*h[e][a]*I))<d[e]&&(d[e]=W,d[e]<g&&(d[e]=g)),W>p[e]&&(p[e]=W,p[e]>s&&(p[e]=s));if(++u===n){for(e=0;e<o;e++)b.setInt8(f++,d[e]),b.setInt8(f++,p[e]),d[e]=1/0,p[e]=-1/0;u=0}}if(u>0)for(e=0;e<o;e++)b.setInt8(f++,d[e]),b.setInt8(f++,p[e]);return m}({scale:e.scale,amplitude_scale:e.amplitude_scale,split_channels:e.split_channels,length:t.length,sample_rate:t.sampleRate,channels:n});a(null,new i(I),t)}else{var l=new r;l.onmessage=function(e){a(null,new i(e.data),t)},l.postMessage({scale:e.scale,amplitude_scale:e.amplitude_scale,split_channels:e.split_channels,length:t.length,sample_rate:t.sampleRate,channels:n},n)}}i.create=function(t){return new i(t)},i.createFromAudio=function(t,e){var a=function(t){return{scale:t.scale||512,amplitude_scale:t.amplitude_scale||1,split_channels:t.split_channels||false,disable_worker:t.disable_worker||false}}(t);if(t.audio_context&&t.array_buffer)return function(t,e,a,n){t.decodeAudioData(e,(function(t){h(t,a,n)}),(function(t){t||(t=new DOMException("EncodingError")),n(t)}))}(t.audio_context,t.array_buffer,a,e);if(t.audio_buffer)return h(t.audio_buffer,a,e);throw new TypeError("WaveformData.createFromAudio(): Pass either an AudioContext and ArrayBuffer, or an AudioBuffer object")},i.prototype={resample:function(t){if(t.scale="number"==typeof t.scale?t.scale:null,t.width="number"==typeof t.width?t.width:null,null!=t.width&&t.width<=0)throw new RangeError("WaveformData.resample(): width should be a positive integer value");if(null!=t.scale&&t.scale<=0)throw new RangeError("WaveformData.resample(): scale should be a positive integer value");if(!t.scale&&!t.width)throw new Error("WaveformData.resample(): Missing scale or width option");var e=t.scale||Math.floor(this.duration*this.sample_rate/t.width),a=this.scale,n=this.length,s=n*this.scale,g=Math.ceil(s/e),I=8===this.bits?1:2,l=24+2*g*this.channels*I,r=new ArrayBuffer(l),h=new DataView(r);h.setInt32(0,2,!0),h.setUint32(4,8===this.bits,!0),h.setInt32(8,this.sample_rate,!0),h.setInt32(12,e,!0),h.setInt32(16,g,!0),h.setInt32(20,this.channels,!0);var o,C=new i(r),c=0,A=0,m=this.channels,b=new Array(m),u=new Array(m);for(o=0;o<m;++o)n>0?(b[o]=this.channel(o).min_sample(c),u[o]=this.channel(o).max_sample(c)):(b[o]=0,u[o]=0);var f,d,p,W,V=8===this.bits?-128:-32768,w=8===this.bits?127:32767;if(e<a)throw new Error("WaveformData.resample(): Zoom level "+e+" too low, minimum: "+a);function Z(t){return Math.floor(t*e)}for(;c<n;){for(;Math.floor(Z(A)/a)===c;){if(A>0)for(o=0;o<m;++o)C.channel(o).set_min_sample(A-1,b[o]),C.channel(o).set_max_sample(A-1,u[o]);if(W=c,(f=Z(++A))!==Z(A-1))for(o=0;o<m;++o)b[o]=w,u[o]=V}for(f=Z(A),(d=Math.floor(f/a))>n&&(d=n);c<d;){for(o=0;o<m;++o)(p=this.channel(o).min_sample(c))<b[o]&&(b[o]=p),(p=this.channel(o).max_sample(c))>u[o]&&(u[o]=p);c++}}if(c!==W)for(o=0;o<m;++o)C.channel(o).set_min_sample(A-1,b[o]),C.channel(o).set_max_sample(A-1,u[o]);return C},concat:function(){var t=this,e=Array.prototype.slice.call(arguments);e.forEach((function(e){if(t.channels!==e.channels||t.sample_rate!==e.sample_rate||t.bits!==e.bits||t.scale!==e.scale)throw new Error("WaveformData.concat(): Waveforms are incompatible")}));var a=this._concatBuffers.apply(this,e);return i.create(a)},_concatBuffers:function(){var t,e,a=Array.prototype.slice.call(arguments),n=this._offset,s=n,g=0,I=[this].concat(a).map((function(t){return t._data.buffer}));for(t=0;t<I.length;t++){e=I[t];var l=new DataView(e).getInt32(16,!0);s+=e.byteLength-n,g+=l}var r=new ArrayBuffer(s),i=new DataView(I[0]),h=new DataView(r);for(t=0;t<n;t++)h.setUint8(t,i.getUint8(t));h.setInt32(16,g,!0);var o=0,C=new Uint8Array(r,n);for(t=0;t<I.length;t++)e=I[t],C.set(new Uint8Array(e,n),o),o+=e.byteLength-n;return r},_offsetValues:function(t,e,a){var n=[],s=this.channels;a+=t*s*2;for(var g=0;g<e;g++)n.push(this._at(g*s*2+a));return n},_version:function(){return this._data.getInt32(0,!0)},get length(){return this._data.getUint32(16,!0)},get bits(){return Boolean(this._data.getUint32(4,!0))?8:16},get duration(){return this.length*this.scale/this.sample_rate},get pixels_per_second(){return this.sample_rate/this.scale},get seconds_per_pixel(){return this.scale/this.sample_rate},get channels(){return 2===this._version()?this._data.getInt32(20,!0):1},channel:function(t){if(t>=0&&t<this._channels.length)return this._channels[t];throw new RangeError("Invalid channel: "+t)},get sample_rate(){return this._data.getInt32(8,!0)},get scale(){return this._data.getInt32(12,!0)},_at:function(t){return 8===this.bits?this._data.getInt8(this._offset+t):this._data.getInt16(this._offset+2*t,!0)},_set_at:function(t,e){return 8===this.bits?this._data.setInt8(this._offset+t,e):this._data.setInt16(this._offset+2*t,e,!0)},at_time:function(t){return Math.floor(t*this.sample_rate/this.scale)},time:function(t){return t*this.scale/this.sample_rate},toJSON:function(){for(var t={version:2,channels:this.channels,sample_rate:this.sample_rate,samples_per_pixel:this.scale,bits:this.bits,length:this.length,data:[]},e=0;e<this.length;e++)for(var a=0;a<this.channels;a++)t.data.push(this.channel(a).min_sample(e)),t.data.push(this.channel(a).max_sample(e));return t},toArrayBuffer:function(){return this._data.buffer}}}}]);